## phpMusselのドキュメンテーション（日本語）。

### 目次
- １.[序文](#SECTION1)
- ２.[インストール方法](#SECTION2)
- ３.[使用方法](#SECTION3)
- ４.[フロントエンドの管理](#SECTION4)
- ５.[ＣＬＩ（コマンドライン・インターフェイス）](#SECTION5)
- ６.[本パッケージに含まれるファイル](#SECTION6)
- ７.[コンフィギュレーション（設定オプション）](#SECTION7)
- ８.[シグネチャ（署名）フォーマット](#SECTION8)
- ９.[適合性問題](#SECTION9)
- １０.[よくある質問（ＦＡＱ）](#SECTION10)
- １１.[法律情報](#SECTION11)

*翻訳についての注意：エラーが発生した場合（例えば、​翻訳の間の不一致、​タイプミス、​等等）、​READMEの英語版が原本と権威のバージョンであると考えられます。​誤りを見つけた場合は、​それらを修正するにご協力を歓迎されるだろう。​*

---


### １.<a name="SECTION1"></a>序文

phpMussel（ピー・エイチ・ピー・マッスル）をご利用頂き、​ありがとうございます。​phpMusselは、​ClamAV をはじめとしたシグネチャを利用して、​システムにアップロードされるファイルを対象して、​トロイ型のウィルスやマルウェア等を検出するようデザインされたPHPスクリプトです。

PHPMUSSEL著作権2013とGNU一般公衆ライセンスv2を超える権利について：​Caleb M (Maikuolan)著。

本スクリプトはフリーウェアです。​フリーソフトウェア財団発行のGNU一般公衆ライセンス・バージョン２（またはそれ以降のバージョン）に従い、​再配布ならびに加工が可能です。​配布の目的は、​役に立つことを願ってのものですが、​『保証はなく、​また商品性や特定の目的に適合するのを示唆するものでもありません』。​『LICENSE.txt』にある『GNU General Public License』（一般ライセンス）を参照して下さい。​以下のURLからも閲覧できます：
- <http://www.gnu.org/licenses/>。
- <http://opensource.org/licenses/>。

作成のインスピレーションと本スクリプトが利用するシグネチャについて[ClamAV](http://www.clamav.net/)に感謝の意を表したいと思います。​この２つがなければ、​本スクリプトは存在しえないか、​あるいは極めて限られた利用価値しかもたないと言ってよいでしょう。

本プロジェクトファイルのホスト先であるSourceForgeとGitHub、​phpMusselが利用するシグネチャの提供先である：​[SecuriteInfo.com](http://www.securiteinfo.com/)、​[PhishTank](http://www.phishtank.com/)、​[NLNetLabs](http://nlnetlabs.nl/) 他、​本プロジェクトを支援して下さった全ての方々に感謝の意を表したいと思います。

本ドキュメントならびに関連パッケージは以下のURLからダウンロードできます。
- [SourceForge](http://phpmussel.sourceforge.net/)。
- [GitHub](https://github.com/phpMussel/phpMussel/)。

---


### ２.<a name="SECTION2"></a>インストール方法

#### 2.0 手動インストール（ウェブサーバー編）

１） 本項を読んでいるということから、​アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。​ホストあるいはＣＭＳに`/public_html/phpmussel/`のようなディレクトリを作り、​ローカルマシンからそこにコンテンツをアップロードするのが次のステップです。​アップロード先のディレクトリ名や場所については、​安全でさえあれば、​もちろん制約などはありませんので、​自由に決めて下さい。

２） `config.ini`に`config.ini.RenameMe`の名前を変更します（`vault`の内側に位置する）。​オプションの修正のため（初心者には推奨できませんが、​経験が豊富なユーザーには強く推奨します）、​それを開いて下さい（本ファイルはphpMusselが利用可能なディレクティブを含んでおり、​それぞれのオプションについての機能と目的に関した簡単な説明があります）。​セットアップ環境にあわせて、​適当な修正を行いファイルを保存して下さい。

３） コンテンツ（phpMussel本体とファイル）を先に定めたディレクトリにアップロードします。​（`*.txt`や`*.md`ファイルはアップロードの必要はありませんが、​大抵は全てをアップロードしてもらって構いません）。

４） `vault`ディレクトリは「７５５」にアクセス権変更します（問題がある場合は、​「７７７」を試すことができます；これは、​しかし、​安全ではありません）。​コンテンツをアップロードしたディレクトリそのものは、​通常特に何もする必要ありませんが、​過去にパーミッションで問題があった場合、​CHMODのステータスは確認しておくと良いでしょう。​（デフォルトでは「７５５」が一般的です）。

５） あなたが必要とするシグネチャをインストールしてください。 参照：​[シグネチャ・インストール](#INSTALLING_SIGNATURES)。

６） 次に、​システム内あるいはＣＭＳにphpMusselをフックします。​方法はいくつかありますが、​最も容易なのは、​`require`や`include`でスクリプトをシステム内またはＣＭＳのコアファイルの最初の部分に記載する方法です。​（コアファイルとは、​サイト内のどのページにアクセスがあっても必ずロードされるファイルのことです）。​一般的には、​`/includes`や`/assets`や`/functions`のようなディレクトリ内のファイルで、​`init.php`、​`common_functions.php`、​`functions.php`といったファイル名が付けられています。​実際にどのファイルなのかは、​見つけてもうらう必要があります。​よく分からない場合は、​phpMusselサポートフォーラムを参照するか、​またはGitHubのでphpMusselの問題のページ、​あるいはお知らせください（ＣＭＳ情報必須）。​私自身を含め、​ユーザーの中に類似のＣＭＳを扱った経験があれば、​何かしらのサポートを提供できます。​コアファイルが見つかったなら、​「`require`か`include`を使って」以下のコードをファイルの先頭に挿入して下さい。​ただし、​クォーテーションマークで囲まれた部分は`loader.php`ファイルの正確なアドレス（HTTPアドレスでなく、​ローカルなアドレス。​前述のvaultのアドレスに類似）に置き換えます。

`<?php require '/user_name/public_html/phpmussel/loader.php'; ?>`

ファイルを保存して閉じ、​再アップロードします。

-- 他の手法 --

Apacheウェブサーバーを利用していて、​かつ`php.ini`を編集できるようであれば、​`auto_prepend_file`ディレクティブを使って、​ＰＨＰリクエストがあった場合にはいつもphpMusselを先頭に追加するようにすることも可能です。​以下に例を挙げます。

`auto_prepend_file = "/user_name/public_html/phpmussel/loader.php"`

あるいは、​`.htaccess`において：

`php_value auto_prepend_file "/user_name/public_html/phpmussel/loader.php"`

７） これでインストールは完了ですが、​念のために、​テストを行いましょう。​不正ファイルアップロード保護機能をテストするには、​パッケージ内の`_testfiles`に含まれているテストファイルをブラウザを使った通常の方法でアップロードします。​問題がなければ、​phpMusselからアップロードをブロックしたとのメッセージが表示され、​そうでない場合は何かが正常に機能していません。​また、​もし何かしら特殊な機能を使っている、​ないしは他のタイプのスキャニングも使っているようであれば、​相互に影響があるかないかもチェックしておく方が良いでしょう。

#### 2.1 手動インストール（ＣＬＩ編）

１） 本項を読んでいるということから、​アーカイブ・スクリプトのローカルマシンへのダウンロードと解凍は終了していると考えます。​phpMusselの保存場所が決まったら、​次へ進んで下さい。

２） phpMusselを使うには、​ＰＨＰがホストマシンにインストールされている必要があります。​もし、​まだであれば、​各種ＰＨＰインストーラーのどれを使っても構いませんので、​インストールして下さい。

３） オプションの修正のため（初心者には推奨できませんが、​経験が豊富なユーザーには強く推奨します）。​`vault`内の`config.ini`を開いて下さい。​本ファイルはphpMusselが利用可能なディレクティブを含んでおり、​それぞれのオプションについての機能と目的に関した簡単な説明があります。​セットアップ環境にあわせて、​適当な修正を行いファイルを保存して下さい。

４） オプションですが、​バッチファイルを作成することにより、​phpMusselのＣＬＩモードでの使用を容易にすることができます。​バッチファイルはＰＨＰとphpMusselを自動的にロードするものです。​まず、​Notepadか Notepad++のようなテキストエディタを開いて下さい。​そして、​インストールしたＰＨＰの`php.exe`の絶対パス、​半角スペース、​`loader.php`の絶対パスをタイプして、​拡張子「.bat」でファイルを目につくところに保存します。​このファイルをダブルクリックすることでphpMusselを起動することができます。

５） あなたが必要とするシグネチャをインストールしてください。 参照：​[シグネチャ・インストール](#INSTALLING_SIGNATURES)。

６） テストを行いましょう。​パッケージ内の`_testfiles`をphpMusselでスキャンしてみて下さい。

#### 2.2 COMPOSERを使用してインストールする

[phpMusselはPackagistに登録されています](https://packagist.org/packages/phpmussel/phpmussel)。​Composerを使い慣れている場合は、​Composerを使用してphpMusselをインストールできます （あなたはまだ設定とフックを準備する必要があります；​「手動インストール（ウェブサーバー編）」の手順２と６を参照してください）。

`composer require phpmussel/phpmussel`

#### <a name="INSTALLING_SIGNATURES"></a>2.3 シグネチャ・インストール

`v1.0.0`以降、シグネチャはphpMusselパッケージには含まれていません。​特定の脅威を検出するためには、phpMusselによってシグネチャが必要です。​シグネチャをインストールする主な方法は３つあります。

1. フロントエンドのアップデート・ページを使用して自動的にインストールします。
2. 「SigTool」を使用してシグネチャを生成し、手動でインストールします。
3. 「phpMussel/Signatures」からシグネチャをダウンロードし、手動でインストールします。

##### 2.3.1 フロントエンドのアップデート・ページを使用して自動的にインストールします。

まず、フロントエンドが有効になっていることを確認する必要があります。 *参照：[フロントエンドの管理](#SECTION4)。*

次に、フロントエンドのアップデート・ページに移動し、必要なシグネチャ・ファイルを見つける、その後、ページに用意されているオプションを使用して、インストールし、アクティブ化します。

##### 2.3.2 「SigTool」を使用してシグネチャを生成し、手動でインストールします。

*参照：[SigToolドキュメンテーション](https://github.com/phpMussel/SigTool#documentation)。*

##### 2.3.3 「phpMussel/Signatures」からシグネチャをダウンロードし、手動でインストールします。

まず、[phpMussel/Signatures](https://github.com/phpMussel/Signatures)に行く。​リポジトリには、​さまざまなＧＺ圧縮シグネチャ・ファイルが含まれています。​それらをインストールするには、​必要なファイルをダウンロードして解凍し、​解凍したファイルを`/vault/signatures`ディレクトリにコピーします。​それらをアクティブにするには、​コピーしたファイルの名前をphpMussel設定の`Active`ディレクティブに列挙します。

---


### ３.<a name="SECTION3"></a>使用方法

#### 3.0 使用方法（ウェーブサーバー編）

phpMusselは特別な使用環境を必要としないスクリプトです。​一度インストールされれば、​充分に機能します。

デフォルトでは、​アップロードされたファイルのスキャンは自動的に行うように設定されています。​従って基本的に何もすることはありません。

ですが、​特定のファイル、​ディレクトリ、​アーカイブをスキャンするよう設定することも可能です。​`config.ini`を適切に設定し直して下さい（クリーンアップは無効でなくてはなりません）。​その後phpMusselがフックされているＰＨＰファイル内において、​以下のコードを使用します。

`$phpMussel['Scan']($what_to_scan, $output_type, $output_flatness);`

- `$what_to_scan` には、​文字列あるいは（多次元）配列を代入することができます。​どのファイル（一つないしは複数）あるいはディレクトリ（一つないしは複数）をスキャンすべきか指定します。
- `$output_type` はブーレアンで、​スキャン結果のフォーマットを指定できます。​`false`は結果を整数型で返します。​`true`（真）は結果をテキスト形式で返します。​どちらを選択しても、​スキャン後にグローバル変数によって結果にアクセスすることが可能です。​`$output_type`はオプションでデフォルト設定は`false`（偽）になっています。​次に、整数結果について説明します。

| 結果 | 説明 |
|---|---|
| ー３ | ​phpMusselのシグネチャ・ファイルかシグネチャ・マップがない、​もしくは破損している可能性があることを示しています。​ |
| ​ー２ | スキャン中に破損データを検出したためスキャン失敗。 |
| ー１ | ＰＨＰがスキャンに必要な拡張子あるいはアドオンがないためにスキャン失敗。 |
| ０ | スキャンの対象が存在しないこと。 |
| ​１ | 対象のスキャンを完了しかつ問題がないこと。 |
| ​２ | 対象のスキャンを完了しかつ問題を検出したことを意味します。 |

- `$output_flatness` はブーレアンで、​スキャン結果を配列で返すか、​文字列で返すかを指定します（対象が複数の場合）。​`false`（偽）は配列、​`true`（真）は文字列での返り値となります。​`$output_flatness`はオプションでデフォルト設定は`false`（偽）です。

例：

```PHP
 $results = $phpMussel['Scan']('/user_name/public_html/my_file.html', true, true);
 echo $results;
```

の場合、​返り値は：

```
 Wed, 16 Sep 2013 02:49:46 +0000 開始。
 > チェック '/user_name/public_html/my_file.html':
 -> 問題は検出されませんでした。
 Wed, 16 Sep 2013 02:49:47 +0000 完了。
```

phpMusselがどのようなシグネチャを使ったか等の詳細な情報については、​本ファイルのセクション『[シグネチャ（署名）フォーマット](#SECTION8)』を参照して下さい。

誤検出や新種の疑わしきものに遭遇した、​あるいはシグネチャに関することについては何でもお知らせ下さい。​そうすれば、​即時対応でき、​必要な修正を行うことができます。 *（参照する：​[「偽陽性」とは何ですか？​](#WHAT_IS_A_FALSE_POSITIVE)）。*

phpMusselに含まれるシグネチャを無効にするには（通常除かれるべきではないと考えられるものがブロックされてしまうような場合）、​それらの名前をグレーリスト・ファイルに追加する（`/vault/greylist.csv`）、カンマで区切られた。

*また見てください： [ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？](#SCAN_DEBUGGING)*

#### 3.1 使用方法（ＣＬＩ編）

本READMEファイルの「手動インストール（ＣＬＩ編）」を参照して下さい。

なお、​phpMusselを通常のウィルスソフトと混同しないで下さい。​アクティブメモリーを監視してウィルスを即時検出するものではありません（phpMusselは、​オンデマンドスキャナです；phpMusselは、​オンアクセススキャナではありません）。​指定されたファイルのみをスキャンし（また、​ファイルのアップロード）、​含まれるウィルスを検出します。

---


### ４.<a name="SECTION4"></a>フロントエンドの管理

#### 4.0 フロントエンドは何です。

フロントエンドは、​phpMusselのインストールを維持、​管理、​更新するための便利で簡単な方法を提供します。​ログページを使用してログファイルを表示、​共有、​ダウンロードすることができます、​コンフィギュレーションページでコンフィギュレーションを変更できます、​アップデートページを使用してコンポーネントをインストールおよびアンインストールできます、​そして、​ファイル・マネージャーを使用してvault「ボールト」内のファイルをアップロード、​ダウンロード、​および変更することができます。

不正アクセスを防止するため、​フロントエンドはデフォルトで無効になっています （不正アクセスがウェブサイトとそのセキュリティに重大な影響を与える可能性があります）。​それを可能にするための指示は、​このパラグラフの下に含まれています。

#### 4.1 フロントエンドを有効にする方法。

１） `config.ini`の中にある`disable_frontend`ディレクティブを探します、​それを「`false`」に設定します（デフォルトでは「`true`」です）。

２） ブラウザから`loader.php`にアクセスしてください（例えば、​`http://localhost/phpmussel/loader.php`）。

３） デフォルトのユーザー名とパスワードでログインする（admin/password）。

注意：あなたが初めてログインした後、​フロントエンドへの不正アクセスを防ぐために、​あなたはすぐにユーザー名とパスワードを変更する必要があります！​これは非常に重要です、​なぜなら、​フロントエンドから任意のＰＨＰコードをあなたのウェブサイトにアップロードすることができるからです。

#### 4.2 フロントエンドの使い方。

フロントエンドの各ページには、​目的の説明とその使用方法の説明があります。​詳しい説明や特別な支援が必要な場合は、​サポートにお問い合わせください。​また、​デモを提供するYouTube上で利用可能な動画もあります。


---


### ５.<a name="SECTION5"></a>ＣＬＩ（コマンドライン・インターフェイス）

phpMusselはウィンドウズベースのシステムでは、​ＣＬＩモードで対話式のファイルスキャナーとしても機能します。​詳細についてはインストール方法（ＣＬＩ編）を参照して下さい。

ＣＬＩプロンプトにて`c`とタイプしエンターを押せば、​利用可能なＣＬＩコマンドのリストが表示されます。

また、​興味のある人のために、​ＣＬＩモードでphpMusselを使用する方法のためのビデオチュートリアルは、​ここで提供されています：
- <https://youtu.be/H-Pa740-utc>

---


### ６.<a name="SECTION6"></a>本パッケージに含まれるファイル

以下はアーカイブから一括ダウンロードされるファイルのリスト、​ならびにスクリプト使用により作成されるファイルとこれらのファイルが何のためかという簡単な説明です。

ファイル | 説明
----|----
/_docs/ | ドキュメンテーション用のディレクトリです（様々なファイルを含みます）。
/_docs/readme.ar.md | アラビア語ドキュメンテーション。
/_docs/readme.de.md | ドイツ語ドキュメンテーション。
/_docs/readme.en.md | 英語ドキュメンテーション。
/_docs/readme.es.md | スペイン語ドキュメンテーション。
/_docs/readme.fr.md | フランス語ドキュメンテーション。
/_docs/readme.id.md | インドネシア語ドキュメンテーション。
/_docs/readme.it.md | 伊語ドキュメンテーション。
/_docs/readme.ja.md | 日本語ドキュメンテーション。
/_docs/readme.ko.md | 韓国語ドキュメンテーション。
/_docs/readme.nl.md | オランダ語ドキュメンテーション。
/_docs/readme.pt.md | ポルトガル語ドキュメンテーション。
/_docs/readme.ru.md | ロシア語ドキュメンテーション。
/_docs/readme.ur.md | ウルドゥー語ドキュメンテーション。
/_docs/readme.vi.md | ベトナム語ドキュメンテーション。
/_docs/readme.zh-TW.md | 繁体字中国語ドキュメンテーション。
/_docs/readme.zh.md | 簡体字中国語ドキュメンテーション。
/_testfiles/ | テストファイルのディレクトリです（様々なファイルを含んでいます）。​phpMusselがシステムに正しくインストールされたかどうかをテストするファイルです。​テスト以外の目的でこのディレクトリをアップロードすることはありません。
/_testfiles/ascii_standard_testfile.txt | phpMussel正規化ASCIIシグネチャ用テストファイル。
/_testfiles/coex_testfile.rtf | phpMussel拡張コンプレックスシグネチャ用テストファイル。
/_testfiles/exe_standard_testfile.exe | phpMussel ＰＥシグネチャ用テストファイル。
/_testfiles/general_standard_testfile.txt | phpMussel一般シグネチャ用テストファイル。
/_testfiles/graphics_standard_testfile.gif | phpMusselグラフィックシグネチャ用テストファイル。
/_testfiles/html_standard_testfile.html | phpMussel正規化ＨＴＭＬシグネチャテストファイル。
/_testfiles/md5_testfile.txt | phpMussel ハッシュ・シグネチャ用テストファイル。
/_testfiles/ole_testfile.ole | phpMussel ＯＬＥシグネチャ用テストファイル。
/_testfiles/pdf_standard_testfile.pdf | phpMussel ＰＤＦシグネチャ用テストファイル。
/_testfiles/pe_sectional_testfile.exe | phpMussel ＰＥセクショナルシグネチャ用テストファイル。
/_testfiles/swf_standard_testfile.swf | phpMussel ＳＷＦシグネチャ用テストファイル。
/vault/ | ヴォルト・ディレクトリ（様々なファイルを含んでいます）。
/vault/cache/ | キャッシュ・ディレクトリ（一時データ用）。
/vault/cache/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/fe_assets/ | フロントエンド資産。
/vault/fe_assets/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/fe_assets/_accounts.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_accounts_row.html | フロントエンドのアカウント・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_cache.html | フロントエンドのキャッシュ・データ・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_config.html | フロントエンドのコンフィギュレーション・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_config_row.html | フロントエンドのコンフィギュレーション・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_files.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_edit.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_rename.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_files_row.html | ファイル・マネージャのＨＴＭＬテンプレート。
/vault/fe_assets/_home.html | フロントエンドのホームページのＨＴＭＬテンプレート。
/vault/fe_assets/_login.html | フロントエンドのログインページのＨＴＭＬテンプレート。
/vault/fe_assets/_logs.html | フロントエンドのロゴスページのＨＴＭＬテンプレート。
/vault/fe_assets/_nav_complete_access.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、​は完全なアクセスのためのものです。
/vault/fe_assets/_nav_logs_access_only.html | フロントエンドのナビゲーションリンクのＨＴＭＬテンプレート、​はログのみにアクセスのためのものです。
/vault/fe_assets/_quarantine.html | フロントエンドの検疫ページのＨＴＭＬテンプレート。
/vault/fe_assets/_quarantine_row.html | フロントエンドの検疫ページのＨＴＭＬテンプレート。
/vault/fe_assets/_statistics.html | フロントエンドの統計ページのＨＴＭＬテンプレート。
/vault/fe_assets/_updates.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_updates_row.html | フロントエンドのアップデート・ページのＨＴＭＬテンプレート。
/vault/fe_assets/_upload_test.html | アップロード・テスト・ページのＨＴＭＬテンプレート。
/vault/fe_assets/frontend.css | フロントエンドのＣＳＳスタイルシート。
/vault/fe_assets/frontend.dat | フロントエンドのデータベース（アカウント情報とセッション情報が含まれています；​フロントエンドが有効になっているときに作成）。
/vault/fe_assets/frontend.html | フロントエンドのメインテンプレートファイル。
/vault/fe_assets/icons.php | アイコン・ハンドラ（フロント・エンド・ファイル・マネージャによって使用される）。
/vault/fe_assets/pips.php | ピップス・ハンドラ（フロント・エンド・ファイル・マネージャによって使用される）。
/vault/fe_assets/scripts.js | フロントエンドJavaScriptデータが含まれています。
/vault/lang/ | phpMusselの言語データを含んでいます。
/vault/lang/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/lang/lang.ar.fe.php | フロントエンドのアラビア語言語データ。
/vault/lang/lang.ar.php | アラビア語言語データ。
/vault/lang/lang.bn.fe.php | フロントエンドのベンガル語言語データ。
/vault/lang/lang.bn.php | ベンガル語言語データ。
/vault/lang/lang.de.fe.php | フロントエンドのドイツ語言語データ。
/vault/lang/lang.de.php | ドイツ語言語データ。
/vault/lang/lang.en.fe.php | フロントエンドの英語言語データ。
/vault/lang/lang.en.php | 英語言語データ。
/vault/lang/lang.es.fe.php | フロントエンドのスペイン語言語データ。
/vault/lang/lang.es.php | スペイン語言語データ。
/vault/lang/lang.fr.fe.php | フロントエンドのフランス語言語データ。
/vault/lang/lang.fr.php | フランス語言語データ。
/vault/lang/lang.hi.fe.php | フロントエンドのヒンディー語言語データ。
/vault/lang/lang.hi.php | ヒンディー語言語データ。
/vault/lang/lang.id.fe.php | フロントエンドのインドネシア語言語データ。
/vault/lang/lang.id.php | インドネシア語言語データ。
/vault/lang/lang.it.fe.php | フロントエンドの伊語言語データ。
/vault/lang/lang.it.php | 伊語言語データ。
/vault/lang/lang.ja.fe.php | フロントエンドの日本語言語データ。
/vault/lang/lang.ja.php | 日本語言語データ。
/vault/lang/lang.ko.fe.php | フロントエンドの韓国語言語データ。
/vault/lang/lang.ko.php | 韓国語言語データ。
/vault/lang/lang.nl.fe.php | フロントエンドのオランダ語言語データ。
/vault/lang/lang.nl.php | オランダ語言語データ。
/vault/lang/lang.pt.fe.php | フロントエンドのポルトガル語言語データ。
/vault/lang/lang.pt.php | ポルトガル語言語データ。
/vault/lang/lang.ru.fe.php | フロントエンドのロシア語言語データ。
/vault/lang/lang.ru.php | ロシア語言語データ。
/vault/lang/lang.th.fe.php | フロントエンドのタイ語言語データ。
/vault/lang/lang.th.php | タイ語言語データ。
/vault/lang/lang.tr.fe.php | フロントエンドのトルコ語言語データ。
/vault/lang/lang.tr.php | トルコ語言語データ。
/vault/lang/lang.ur.fe.php | フロントエンドのウルドゥー語言語データ。
/vault/lang/lang.ur.php | ウルドゥー語言語データ。
/vault/lang/lang.vi.fe.php | フロントエンドのベトナム語言語データ。
/vault/lang/lang.vi.php | ベトナム語言語データ。
/vault/lang/lang.zh-tw.fe.php | フロントエンドの繁体字中国語言語データ。
/vault/lang/lang.zh-tw.php | 繁体字中国語言語データ。
/vault/lang/lang.zh.fe.php | フロントエンドの簡体字中国語言語データ。
/vault/lang/lang.zh.php | 簡体字中国語言語データ。
/vault/quarantine/ | 検疫ディレクトリ（検疫されたファイル含んでいます）。
/vault/quarantine/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/signatures/ | シグネチャディレクトリ（シグネチャファイルが含まれています）。
/vault/signatures/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/signatures/switch.dat | 変数をコントロール、​セットします。
/vault/.htaccess | ハイパーテキスト・アクセスファイル（この場合、​本スクリプトの重要なファイルを権限のないソースのアクセスから保護するためです）。
/vault/.travis.php | テストのためにTravis CIによって使用される​（機能には関係のないファイルです）。
/vault/.travis.yml | テストのためにTravis CIによって使用される​（機能には関係のないファイルです）。
/vault/cli.php | ＣＬＩハンドラ。
/vault/components.dat | phpMusselのコンポーネント情報が含まれています；​アップデート機能で使用（フロントエンドが提供します）。
/vault/config.ini.RenameMe | phpMussel設定ファイル；​phpMusselの全オプション設定を記載しています。​それぞれのオプションの機能と動作手法の説明です（アクティブにするために名前を変更します）。
/vault/config.php | コンフィギュレーション・ハンドラ。
/vault/config.yaml | 設定・デフォルトス・ファイル；phpMusselのデフォルト設定値が含まれます。
/vault/frontend.php | フロントエンド・ハンドラ。
/vault/frontend_functions.php | フロントエンド機能ファイル。
/vault/functions.php | 関数ファイル（本質的ファイル）。
/vault/greylist.csv | グレーリスト化されたシグネチャのＣＳＶで、​phpMusselがどのシグネチャを無視すべきかを指示するものです（削除しても自動的に再作成されます）。
/vault/lang.php | 言語・ハンドラ。
/vault/php5.4.x.php | PHP 5.4.X ポリフィル （PHP 5.4.X の下位互換性のために必要です；​より新しいＰＨＰバージョンのために、​削除しても安全です）。
※ /vault/scan_kills.txt | phpMusselによりブロック/削除されたアップロードファイルの全記録。
※ /vault/scan_log.txt | phpMusselによりスキャンされたものの全記録。
※ /vault/scan_log_serialized.txt | phpMusselによりスキャンされたものの全記録。
/vault/template_custom.html | phpMusselテンプレートファイル；​phpMusselがファイルアップロードをブロックした際に作成されるメッセージのHTML出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/template_default.html | phpMusselテンプレートファイル；​phpMusselがファイルアップロードをブロックした際に作成されるメッセージのHTML出力用テンプレート（アップローダーが表示するメッセージ）。
/vault/themes.dat | テーマ・ファイル。​アップデート機能で使用（フロントエンドが提供します）。
/vault/upload.php | アップロード・ハンドラ。
/.gitattributes | GitHubのプロジェクトファイル（機能には関係のないファイルです）。
/.gitignore | GitHubのプロジェクトファイル（機能には関係のないファイルです）。
/Changelog-v1.txt | バージョンによる違いを記録したものです（機能には関係のないファイルです）。
/composer.json | Composer/Packagist情報（機能には関係のないファイルです）。
/CONTRIBUTING.md | プロジェクトに貢献する方法について。
/LICENSE.txt | GNU/GPLv2のライセンスのコピー（機能には関係のないファイルです）。
/loader.php | ローダー・ファイルです。​主要スクリプトのロード、​アップロード等を行います。​フックするのはまさにこれです（本質的ファイル）！
/PEOPLE.md | プロジェクトに関わる人々についての情報。
/README.md | プロジェクト概要情報。
/web.config | ASP.NET設定ファイルです（スクリプトがASP.NETテクノロジーを基礎とするサーバーにインストールされた時に`/vault`ディレクトリを権限のないソースによるアクセスから保護するためです）。

※ ファイル名は設定の仕方（`config.ini`内）により異なることがあります。

---


### ７.<a name="SECTION7"></a>コンフィギュレーション（設定オプション）
以下は`config.ini`設定ファイルにある変数ならびにその目的と機能のリストです。

#### "general" （全般、​カテゴリー）
全般的な設定。

"cleanup" （クリーンアップ）
- 初回アップロード後に変数とキャッシュの設定をクリアするか否かについてのスクリプトです。​`false`(偽） = いいえ；​`true`（真） = はい 「Default/デフォルト設定」。​初回アップロードスキャニング以外で使用することがなければ、​`true`（真）としメモリーの使用量を最小にします。​使用するのであれば、​`false`（偽）とし、​メモリーに不要な重複データを再ロードするのを防ぎます。​通常は`true`（真）。​に設定しますが、​初回アップロードスキャニングに対してしか使用できないことを覚えておいて下さい。
- ＣＬＩモードでは影響しません。

"scan_log" （スキャンログ）
- 全スキャニング結果を記録するファイルのファイル名。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"scan_log_serialized" （スキャンログシリアライズド）
- 全スキャニング結果を記録するファイルのファイル名（シリアル化形式を利用）。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"scan_kills" （スキャンキルズ）
- ブロックしたか削除したアップロードの全てを記録するファイのファイル名。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

*有用な先端：​あなたがしたい場合は、​ログファイルの名前に日付/時刻情報を付加することができます、​名前にこれらを含めることで:完全な年のため`{yyyy}`、​省略された年のため`{yy}`、​月`{mm}`、​日`{dd}`、​時間`{hh}`。​*

*例：*
- *`scan_log='scan_log.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_log_serialized='scan_log_serialized.{yyyy}-{mm}-{dd}-{hh}.txt'`*
- *`scan_kills='scan_kills.{yyyy}-{mm}-{dd}-{hh}.txt'`*

"truncate" （トランケート）
- ログファイルが一定のサイズに達したら切り詰めますか？​値は、​ログファイルが切り捨てられる前に大きくなる可能性があるＢ/ＫＢ/ＭＢ/ＧＢ/ＴＢ単位の最大サイズです。​デフォルト値の０ＫＢは切り捨てを無効にします （ログファイルは無期限に拡張できます）。​注：個々のログファイルに適用されます。​ログファイルのサイズは一括して考慮されません。

"log_rotation_limit" （ログ・ローテーション・リミット）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望の制限を指定することができます。​値「0」は、ログ・ローテーションを無効にします。

"log_rotation_action" （ログ・ローテーション・アクション）
- ログ・ローテーションは、一度に存在する必要があるログ・ファイルの数を制限します。​新しいログ・ファイルが作成されると、ログ・ファイルの総数が指定された制限を超えると、指定されたアクションが実行されます。​ここで希望のアクションを指定できます。 「Delete」 = 最も古いログ・ファイルを削除して、制限を超過しないようにします。 「Archive」 = 最初にアーカイブしてから、最も古いログ・ファイルを削除して、制限を超過しないようにします。

*技術的な説明：この文脈では、「最も古い」とは「最近変更されていない」という意味です。*

"timeOffset" （タイム・オフセット）
- お使いのサーバの時刻は、​ローカル時刻と一致しない場合、​あなたのニーズに応じて、​時間を調整するために、​あなたはここにオフセットを指定することができます。​しかし、​その代わりに、​一般的にタイムゾーンディレクティブ（あなたの`php.ini`ファイルで）を調整ーることをお勧めします、​でも時々（といった、​限ら共有ホスティングプロバイダでの作業時）これは何をすることは必ずしも可能ではありません、​したがって、​このオプションは、​ここで提供されています。​オフセット分であります。
- 例（１時間を追加します）：`timeOffset=60`

"timeFormat"
- phpMusselで使用される日付表記形式。​Default（デフォルト設定） = `{Day}, {dd} {Mon} {yyyy} {hh}:{ii}:{ss} {tz}`.

"ipaddr" （アイピーアドレス）
- 接続要求のＩＰアドレスをどこで見つけるべきかについて（Cloudflareのようなサービスに対して有効）。​Default（デフォルト設定） = REMOTE_ADDR。​注意：あなたが何をしているのか、​分からない限り、​これを変更しないでください。

"enable_plugins" （イネーブル・プラグインす）
- プラグインのサポートを有効にしますか？​`false` = いいえ；​`true` = はい 「Default/デフォルト設定」。

"forbid_on_block" （フォービッド・オン・ブロック）
- アップロードファイルがブロックされたメッセージと共に、​phpMusselから４０３ヘッダーを送るべきか、​通常の２００でよいかどうかについて。​`false`（偽） = いいえ（２００） 「Default/デフォルト設定」；​`true`（真） = はい（４０３）。

"delete_on_sight" （デリート・オン・サイト）
- このディレクティブを有効にすると、​検知基準（シグネチャでも何でも）にあったアップロードファイルは直ちに削除されます。​クリーンと判断されたファイルはそのままです。​アーカイブの場合、​問題のファイルが一部であってもアーカイブ全てが削除の対象となります。​アップロードファイルのスキャンにおいては、​本ディレクティブを有効にすることは必須ではありません。​なぜならＰＨＰはスクリプト実行後に自動的にキャッシュの内容を破棄するからです。​言い換えれば、​ファイルが移動されたか、​コピーされたか、​削除されない限り、​ＰＨＰはサーバーにアップロードしたファイルを残しておくことは通常ありません。​このディレクティブはセキュリティーに念を入れる目的で設置されています。​ＰＨＰは稀に予測外の振る舞いをすることがあるからです。​`false`（偽） = スキャニング後、​ファイルはそのまま（デフォルト設定）。​`true`（真） = スキャニング後、​クリーンでなければ直ちに削除。

"lang" （ラング）
- phpMusselのデフォルト言語を設定します。

"numbers" （ナンバーズ）
- 数値の表示方法を指定します。

"quarantine_key" （クオランティン・キ―）
- phpMusselは、​必要とあれば、​phpMusselのヴォルト内で独立してフラグ付ファイルのアップロードを検疫することができます。​一般的なphpMusselのユーザーは、​ウェブサイトやホスティング環境の保護ができれば充分と考えており、​フラグ付のようなものにさらなる分析を加えようまでの要求はないようですので、​無効で構いません。​ですが詳細に分析してマルウェアに備えたいユーザーは有効にすると良いでしょう。​フラグ付ファイルのアップロードの検疫は誤検出のデバッグに役立つことがあります。​検疫機能を無効にするには、​`quarantine_key`ディレクティブを空にしておくか、​空でない場合はディレクティブ内のコンテンツを消去して下さい。​有効にするには、​デイレクティブに何らかの値を入れて下さい。​`quarantine_key`は検疫機能における重要なセキュリティー要素であり、​検疫機能内に保存されたデータの執行を各種の攻撃から守っています。​`quarantine_key`はパスワードと同様に考えて下さい。​長い方がより安全と言えます。​最も効果的な使用法は`delete_on_sight`との併用です。

"quarantine_max_filesize" （クオランティン・マックス・ファイルサイズ）
- 検疫されるファイルサイズの上限。​この値より大きなファイルは検疫されません。​クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、​メモリーが無駄に消費されるのを防ぐ意味で重要です。​デフォルト設定は２ＭＢです。

"quarantine_max_usage" （クオランティン・マックス・ユーセッジ）
- 検疫のために利用する最大メモリー量。​全メモリー量が使用されると、​この範囲内に収まるよう古いファイルが削除の対象となります。​クオランティンの容量を超える異常に大きなファイルサイズによる攻撃で、​メモリーが無駄に消費されるのを防ぐ意味で重要です。​デフォルト設定は６４ＭＢです。

"honeypot_mode" （ハニーポット・モード）
- ハニーポットモードが有効になっていると、​phpMusselはアップロードされてきた全てのファイルを例外なく検疫します。​シグネチャにマッチするかどうかは問題としません。​スキャニングや分析もなされません。​phpMusselをウィルス/マルウェアのリサーチに利用と考えているユーザーにとって有益と言えるでしょう。​ただし、​アップロードファイルのスキャニングという点からは、​あまり推奨できませんし、​ハニーポット・モードを本来の目的以外に使用することもお勧めできません。​デフォルト設定では無効です。​`false`（偽） = Disabled/無効 （Default/デフォルト）；​`true`（真） = Enabled/有効。

"scan_cache_expiry" （スキャン・キャッシュ・エクスパイヤリー）
- phpMusselはスキャニング結果をどれくらいの期間キャッシュすべきか？​秒単位で、​デフォルトは２１，６００秒（６時間）となっています。​０にするとキャッシュ無効になります。

"disable_cli" （ディスエイブル・シーエルアイ）
- ＣＬＩモードを無効にするか？​ＣＬＩモード（シーエルアイ・モード）はデフォルトでは有効になっていますが、​テストツール（PHPUnit等）やＣＬＩベースのアプリケーションと干渉しあう可能性が無いとは言い切れません。​ＣＬＩモードを無効にする必要がなければ、​このデレクティブは無視してもらって結構です。​`false`（偽） = ＣＬＩモードを有効にします（Default/デフォルルト）；​`true`（真） = ＣＬＩモードを無効にします。

"disable_frontend" （ディスエイブル・フロントエンド）
- フロントエンドへのアクセスを無効にするか？​フロントエンドへのアクセスは、​phpMusselをより管理しやすくすることができます。​前記、​それはまた、​潜在的なセキュリティリスクになる可能性があります。​バックエンドを経由して管理することをお勧めします、​しかし、​これが不可能な場合、​フロントエンドへのアクセスが提供され。​あなたがそれを必要としない限り、​それを無効にします。​`false`（偽） = フロントエンドへのアクセスを有効にします；​`true`（真） = フロントエンドへのアクセスを無効にします（Default/デフォルルト）。

"max_login_attempts" （マクス・ログイン・アテンプト）
- ログイン試行の最大回数（フロントエンド）。​Default（デフォルト設定） = ５。

"FrontEndLog" （フロントエンド・ログ）
- フロントエンド・ログインの試みを記録するためのファイル。​ファイル名指定するか、​無効にしたい場合は空白のままにして下さい。

"disable_webfonts" （ディスエイブル・ウェブフォンツ）
- ウェブフォンツを無効にしますか？​True = はい（Default/デフォルルト）；​False = いいえ。

"maintenance_mode" （メンテナンス・モード）
- メンテナンス・モードを有効にしますか？​True = はい；​False = いいえ（Default/デフォルルト）。​フロントエンド以外のすべてを無効にします。​ＣＭＳ、フレームワークなどを更新するときに便利です。

"default_algo" （ディフォールト・アルゴ）
- 将来のすべてのパスワードとセッションに使用するアルゴリズムを定義します。​オプション：​PASSWORD_DEFAULT（Default/デフォルルト）、​PASSWORD_BCRYPT、​PASSWORD_ARGON2I ​（ＰＨＰ >= 7.2.0 が必要）。

"statistics" （スタティスティックス/統計）
- phpMussel使用統計を追跡しますか？​True = はい；​False = いいえ（Default/デフォルルト）。

"allow_symlinks" （アラウ・シムリンクス）
- 場合によっては、phpMusselが特定の方法で名前を付けられたときにファイルに直接アクセスすることができません。​シンボリックリンク（symlink）を介して間接的にファイルにアクセスすると、この問題を解決することがあります。​ただし、シンボリックリンク（symlink）の使用が禁止されたり、管理者権限が必要なシステムもありますので、これは必ずしも実行可能な解決策ではありません。​直接アクセスが不可能な場合、このディレクティブは、phpMusselがシンボリックリンク（symlink）を使って間接的にファイルにアクセスしようとするかどうかを決定します。​True = シンボリックリンクを有効にする；​False = シンボリックリンクを無効にする（Default/デフォルルト）。

#### "signatures" （シグネチャーズ、​カテゴリ）
シグネチャの設定。

"Active" （アクティブ）
- カンマで区切られたアクティブなシグネチャファイルのリスト。

"fail_silently" （フェイル・サイレントリー）
- シグネチャファイルがない、​あるいは破損している場合に、​phpMusselがそれをリポートすべきか否か？​`fail_silently`が無効ならば、​問題はリポートされ、​有効であれば、​問題は無視されたスキャニングレポートが作成されます。​クラッシュするというような害がなければ、​デフォルト設定のままにしておくべきです。​`false`（偽） = Disabled/無効; `true`（真） = Enabled/有効 （Default/デフォルト）。

"fail_extensions_silently" （フェイル・エクステンションズ・サイレントリー）
- 拡張子がない場合にphpMusselがそれをレポートすべきか否か？​`fail_extensions_silently`が無効の場合、​拡張子なしはスキャニング時にレポートされ、​有効の場合は無視され問題は報告されません。​このディレクティブを無効にすることは、​セキュリティーを向上させるかもしれませんが、​誤検出も増加する恐れがあります。​`false`（偽） = Disabled/無効; `true`（真） = Enabled/有効 （Default/デフォルト）。

"detect_adware" （ディテクト・アドウェア）
- phpMusselはアドウェア検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_encryption" （ディテクト・エンクリプション）
- phpMusselは暗号化ファイルを検出してブロックする必要がありますか？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_joke_hoax" （ディテクト・ジョーク・ホークス）
- phpMusselは悪戯/偽造やマルウェア/ウィルス検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_pua_pup" （ディテクト・PUA・PUP）
- phpMusselはPUAs/PUPs検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_packer_packed" （ディテクト・パッカー・パックト）
- phpMusselはパッカーやパックデータ検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_shell" （ディテクト・シェル）
- phpMusselはshellスクリプト検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

"detect_deface" （ディテクト・ディフェーサ）
- phpMusselは改ざんやディフェーサー検出のためにシグネチャを分析すべきか否か？​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

#### "files" （ファイルズ、​カテゴリー）
ファイル取扱い設定。

"max_uploads" （マックス・アップローズ）
- 一度にスキャンできるアップロードファイル数の上限で、​これを超えるとスキャンを中断し、​ユーザーにその旨を知らせ、​論理攻撃からの保護として機能します。​システムやＣＭＳがDDoS攻撃にあい、​phpMusselがオーバーロードしてＰＨＰプロセスに支障をきたすことがないようにするためです。​推奨数は１０ですが、​ハードウェアのスピードによっては、​これ以上/以下がよいということもあるでしょう。​この数は、​アーカイブのコンテンツは含まないことを覚えておいて下さい。

"filesize_limit" （ファイルサイズ・リミット）
- ファイルサイズ上限の単位はＫＢです。​６５５３６＝６４ＭＢ（Default/デフォルト）；​0 = リミットしません（上限なし、​常にグレイリスト化）、​正の数値であれば何でも構いません。​ＰＨＰの設定でメモリーに制限があったり、​アップロードファイルサイズの上限が設定されている場合に有効的です。

"filesize_response" （ファイルサイズ・レスポンス）
- 上限サイズを超えるファイルをどう処理するかについてです。​`false`（偽） = Whitelist（ホワイトリスト）; `true`（真） = Blacklist（ブラックリスト） （Default/デフォルト）。

"filetype_whitelist" （ファイルタイプ・ホワイトリスト）、​"filetype_blacklist" （ファイルタイプ・ブラックリスト）、​"filetype_greylist" （ファイルタイプ・グレーリスト）
- システムが特定タイプのファイルのみアップロードを許可する、​あるいは拒絶する場合は、​ファイルタイプを適切にホワイトリスト、​ブラックリスト、​グレーリストにて分類しておくと、​ファイルタイプによって弾かれるファイルはスキャンをスキップできるため、​スピードアップに繋がります。​フォーマットはＣＳＶ（カンマ区切り）です。​リストによらず全てをスキャンしたい場合は、​変数は空白のままとし、​ホワイトリスト/ブラックリスト/グレーリストを無効にします。
- プロセスの論理的順序:
 - ファイルタイプがホワイトリストに記載されていれば、​スキャンせず、​ブロックせず、​ブラックリストおよびグレイリストに対してチェックを行いません。
 - ファイルタイプがブラックリストに記載されていれば、​スキャンすることなく、​直ちににブロックし、​グレーリストに対してチェックを行いません。
 - グレーリストが空、​あるいはグレーリストが空でなくかつそのファイルタイプがあれば、​通常通りスキャンしブロックするか否かを判断します。​グレーリストが空でなくかつそのファイルタイプが含まれていなければ、​ブラックリストと同様の扱いをすることになり、​スキャンなしにブロックします。

"check_archives" （チェック・アーカイブズ）
- アーカイブのコンテンツに対してチェックを試みるか否かについてです。​`false`（偽） = チェックしない; `true`（真） = チェックする（Default/デフォルト）。
- 現在サポートしているのはBZ、​GZ、​LZF、​ZIP形式です（RAR、​CAB、​7z等は対象外）。
- 本機能は万能ではありませんので、​有効にしておくことを推奨していますが、​必ず全てを検出することを保証するものではありません。
- また現在チェックのアーカイブはZIPに対して再帰的でないことに注意して下さい。

"filesize_archives" （ファイルサイズ・アーカイブズ）
- ファイルサイズのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？​`false` = いいえ（ただグレーリストすべて）; `true` = はい 「Default/デフォルト設定」。

"filetype_archives" （ファイルタイプ・アーカイブズ）
- ファイルタイプのブラックリスト化/ホワイトリスト化をアーカイブのコンテンツに持ち込むか否か？​`false` = いいえ（ただグレーリストすべて） 「Default/デフォルト設定」; `true` = はい。

"max_recursion" （マックス・リカーション）
- アーカイブに対する最大再帰深さです。​デフォルト＝１０。

"block_encrypted_archives" （ブロック・エンクリプティッド・アーカイブズ）
- 暗号化されたアーカイブを検出しブロックするか否か？​phpMusselは暗号化されたアーカイブをスキャンすることはできないので、​アーカイブの暗号化によってphpMussel、​アンチウィルススキャナー等をかいくぐろうとする攻撃者がいるかもしれません。​暗号化されたアーカイブをブロックすることにより、​このようなリスクを回避することができます。​`false`（偽） = いいえ；​`true`（真） = はい（Default/デフォルト）。

#### "attack_specific" （アタック・スペシフィック、​カテゴリー）
アタックースペシフィック　ディレクティブ。

キャメロンアタック検出。​`false`（偽） = オフ; `true`（真） = オン。

"chameleon_from_php" （キャメロン・フロム・ピーエイチピー）
- ファイルでもなくＰＨＰアーカイブとも認識できないファイル中のＰＨＰヘッダーを探します。

"chameleon_from_exe" （キャメロン・フロム・エグゼ）
- 実行ファイルでもなく実行ファイルのアーカイブとも認識できないファイル中の実行ヘッダーや不正なヘッダーの実行ファイルを探します。

"chameleon_to_archive" （キャメロン・トゥ・アーカイブ）
- ヘッダーが正しくないアーカイブを探します（BZ、​GZ、​RAR、​ZIP、​GZをサポート）。

"chameleon_to_doc" （キャメロン・トゥ・ドク）
- ヘッダーが正しくないオフィスドキュメントを探します（DOC、​DOT、​PPS、​PPT、​XLA、​XLS、​WIZをサポート）。

"chameleon_to_img" （キャメロン・トゥ・アイエムジー）
- ヘッダーが正しくない画像ファイルを探します（BMP、​DIB、​PNG、​GIF、​JPEG、​JPG、​XCF、​PSD、​PDD、​WEBPをサポート）。

"chameleon_to_pdf" （キャメロン・トゥ・ピーディーエフ）
- ヘッダーが正しくないPDFファイルを探します。

"archive_file_extensions" （アーカイブ・ファイル・エクステンション）
- 認識可能なアーカイブファイルエクステンションです（フォーマットはＣＳＶ；​問題があった場合にのみ追加あるいは取り除くべきです。​不用意に取り除くと誤検出の原因となる可能性があります。​反対に不用意に追加すると、​アタックースペシフィック検出から追加したものをホワイトリスト化してしまいます。​充分に注意に上、​変更して下さい。​なお、​コンテントレベルにおいてアーカイブを分析することが出来るか否かには影響しません）。​デフォルトでは最も一般なフォーマットをリストしていますが、​意図的に包括的にはしていません。

"block_control_characters" （ブロック・コントロール・キャラクターズ）
- 制御文字を含んだファイルをブロックするか否か（改行以外）？​についてです（[\x00-\x08\x0b\x0c\x0e\x1f\x7f]）。​もし、​テキストのみをアップロードするなら、​このオプションを有効にして、​さらにプロテクションを強化できます。​テキスト以外もアップロード対象であれば、​有効にすると誤検出の原因になりえます。​`false`（偽） = ブロックしない（Default/デフォルト）；​`true`（真） = ブロックする。

"corrupted_exe" （コラプティッド・エグゼ）
- 破損ファイルとエラー解析。​`false`（偽） = 無視する；​`true`（真） = ブロックする（Default/デフォルト）。​破損の可能性があるPEファイルをブロックし検出するか否か？​についてです。​ＰＥファイルの一部が破損し、​正しく分析できないことは珍しくなく、​ウィルス感染をみるバロメーターになります。​ＰＥファイル内のウィルスを検出するアンチウィルスプログラムは、​ＰＥファイルの解析を行いますが、​ウィルスを作る側では、​ウィルスが検出されないようそれを避けようとするものだからです。

"decode_threshold" （デコード・スレッシュホールド）
- デコード・コマンドが検出されるべき生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。​デフォルト＝５１２ＫＢ。​ゼロあるいは値なし（null）はしきい値を無効化します（ファイルサイズによる制限を取り除きます）。

"scannable_threshold" （スキャナブル・スレッシュホールド）
- phpMusselが読みスキャンしてよい生データの長さの制限（スキャニング中に顕著な問題がある場合に必要に応じて設定）。​デフォルト＝３２ＭＢ。​ゼロあるいは値なし（null）はしきい値を無効化します。​値は、​サーバーやウェブサイトでアップロードされるファイルの平均ファイルサイズより大きく、​filesize_limitディレクティブより小さく設定すべきです。​また`php.ini`設定によってＰＨＰに割り当てられたメモリーのおおよそ5分の１を超えるべきではありません。​このディレクティブはphpMusselがメモリーを使い過ぎないようにするためのものです。​（一定のサイズ以上のファイルはスキャンできなくなることもあります）。

#### "compatibility" （コンパーティブリティ、​カテゴリ）
phpMusselの互換性ディレクティブ。

"ignore_upload_errors" （イグノア・アップロード・エラーズ）
- システム上でphpMusselの機能に修正が必要でない限りはこのディレクティブは通常無効です。​無効に設定すると、​`$_FILES` array()に要素の存在を検知したとき、​その要素が表すファイルのスキャンが開始され、​要素が空白か無であればphpMusselはエラーメッセージを返します。​これは本来phpMusselがあるべき姿です。​しかしＣＭＳにおいては、​$_FILESの空要素は普通に発生するものであり、​正常なphpMusselの挙動が正常なＣＭＳの挙動を阻害する恐れがあります。​このような場合は、​本オプションを有効にして、​phpMusselが空要素をスキャンしてエラーメッセージを返すのを避け、​要求のあったページへスムーズに進むことができるようにします。​`false`（偽） = OFF （オフ）；​`true`（真） = ON （オン）です。

"only_allow_images" （オンリー・アロウ・イメージ）
- システムあるいはＣＭＳに画像ファイルのアップロードのみを許可するのであれば、​このディレクティブは有効にすべきであり、​そうでなければ無効とします。​有効にすると、​画像と特定できないファイルはスキャンすることなしにブロックしますので、​プロセス時間の短縮とメモリーの節約が期待できます。​`false`（偽） = OFF （オフ）；​`true`（真） = ON （オン） です。

#### "heuristic" （ヒューリスティック、​カテゴリ）
ヒューリスティック・ディレクティブズ。

"threshold" （スレッシュホールド）
- phpMusselには、​このファイルは疑わしく危険性が高いと判断するシグネチャがあります。​しきい値は、​アップロードされているファイルの危険性の最大値であり、​これを超えるとマルウェアと判断されます。​ここにおける危険性の定義とは、​疑わしいと特定されたものの総数です。​デフォルトでは３に設定されています。​これより低いと誤検出の可能性が増え、​大きすぎると、​誤検出は減るものの危険性のあるファイルが検出されない可能性が増加してしまいます。​特に問題がなければ、​デフォルト値のままにしておくことお勧めします。

#### "virustotal" （ウィルストータル、​カテゴリ）
VirusTotal.comディレクティブズ。

"vt_public_api_key" （ヴィティ・パブリック・エイピーアイ・キー）
- オプションですが、​phpMusselはVirus Total APIを使ってファイルをスキャンすることができます。​ウィルス、​トロイの木馬、​マルウェア、​その他の攻撃に対して非常に効果的に機能します。​デフォルトではVirus Total APIを使ったスキャニングは無効になっています。​有効にするには、​Virus TotalのAPIキーが必要です。​メリットが極めて大きいため、​有効にすることを強く推奨します。​Virus Total APIの使用にあたっては、​Virus Totalのドキュメンテーションにある通り、​利用規定ならびにガイドラインを遵守しなくてはなりません。​この統合機能を使用するためには：
 - Virus TotalとAPIのサービス規定を読み同意すること。​[サービス規定はこちらから](https://www.virustotal.com/en/about/terms-of-service/)。
 - 最低でもVirus Total Public APIドキュメンテーションの前文を読み理解すること（「VirusTotal Public API v2.0」以降、「Contents」前まで）。​Virus Total Public APIの[ドキュメンテーションはこちらから](https://www.virustotal.com/en/documentation/public-api/)。

注意：Virus Total API使用したスキャニングが無効になっている場合、​このカテゴリー（`virustotal`）のディレクティブを参照する必要はありません。​無効であれば、​どれも機能しません。​Virus Total APIキーを取得するには、​Virus Totalのサイトのページ右上にあるリンク「コミュニティに参加」をクリックして、​必要事項を記入しサインアップします。​インストラクションに従ってパブリックAPIキーを取得した後、​`config.ini`設定ファイルの`vt_public_api_key`ディレクティブのそれをコピー＆ペーストして下さい。

"vt_suspicion_level" （ヴィティ・サスピション・レベル）
- デフォルト設定では、​phpMusselがVirus Total APIを使ってスキャンするファイル（疑がわしいもの）には制限があります。​`vt_suspicion_level`ディレクティブを編集することのより、​この制限を変更することが可能です。
- `0`：​phpMusselのシグネチャを使ってスキャンした結果、​ヒューリスティックな重みがあると判断された場合にのみ、​疑わしいファイルと結論付けられます。​すなわちVirus Total APIは、​phpMusselが危険性を察知はしたが完全にそうとは言い切れず、​したがってブロックもせず、​フラグを付けることもしなかった時のセカンドオピニオンです。
- `1`：​phpMusselのシグネチャを使ってスキャンした結果、​実行ファイルと思われる（PEファイル、​Mach-O ファイル、​ELF/Linuxファイル等）、​ないしは実行可能なデータを含んだフォーマット（マクロ、​DOC/DOCXファイル、​アーカイブRAR/ZIPファイル等)があれば、​ヒューリスティックな重みがあるとして疑わしいファイルと結論付けられます。​これはデフォルト設定であり、​推奨レベルでもあります。​Virus Total APIは、​phpMusselが危険性なしと判断し、​したがってブロックもせず、​フラグを付けることもしなかった時のセカンドオピニオンです。
- `2`：​ファイルは全て疑わしいものとされ、​Virus Total APIを使ってスキャンされます。​API割り当てを使い切る恐れがあるため、​推奨は控えますが、​状況によっては適切と言えるでしょう（例えば、​ウェブマスターやホストマスターがアップロードされる内容を信頼できない状況等）。​この警戒レベルでは、​通常ブロック/フラグも対象にならないファイルも全てVirus Total APIを使ってスキャンされます。​したがって、​Virus Total APIの割り当てを早々に消費してしまうこともあり得、​またAPI割り当てを使い切れば、​phpMusselはVirus Total APIの使用を中止します（警戒レベルに関係なく）。

注意：phpMusselによってブラックリスト化、​ホワイトリスト化されたファイルはVirus Total APIを使ったスキャンの対象にはなりません。​これらは既に善悪が結論付けられたものであり、​Virus Total APIで再びスキャンする必要性はないためです。​phpMusselが、​Virus Total APIを利用するのは、​phpMussel自身が危険性の有無について判断しかねる状況においての補助と言えます。

"vt_weighting" （ヴィティ・ウェイティング）
- phpMusselがVirus Total APIを使ったスキャニング結果を検出として扱うか、​検出の重み付けとして扱うべきか？​複数のエンジン（Virus Totalのように）を使用したスキャニングは、​検出率の向上（より多くのマルウェアが検出）をもたらす一方で誤検出の増加も招くため、​このディレクティブが存在します。​したがって、​スキャニング結果は、​決定的判断ではなく信頼スコアとして利用した方が適当なケースもあります。​値が０の場合、​Virus Total APIを使ったスキャンは検出として扱われ、​Virus Totalのエンジンがマルウェアとフラグを付けたファイルは、​phpMusselもマルウェアと判断します。​その他の値の場合は結果は検出の重み付けとなり、​スキャンされたファイルがマルウェアかどうかphpMusselが判断するための信頼スコア（あるいは検出の重み付け）となります（値はマルウェアと判断するための最小信頼スコア、​あるいは重み）。​デフォルト値は０です。

"vt_quota_rate" （ヴィティ・クォータ・レート） と "vt_quota_time" （ヴィティ・クォータ・タイム）
- Virus Total APIのドキュメンテーションによると「１分間のタイムフレームの間にリクエストは最大４回」の上限があります。​ハニークライアントやハニーポット等のオートメーションを使用し、​リポートを受け取るだけでなく、​VirusTotal にリソースを提供していれば、​上限は引き上げられます。​phpMussel のデフォルトでは最大４回を遵守していますが、​前述の事情から、​この２つのディレクトリを準備し、​状況に合わせて変更できるようになっています。​制限に達してしまうといった不都合や問題がない限りデフォルト値を変更することは勧められませんが、​値を小さくすることが適当なケースもあります。​上限はタイムフレーム`vt_quota_time`（ヴィティ・クォータ・タイム）「分内に」`vt_quota_rate`（ヴィティ・クォータ・レート）で設定します。

#### "urlscanner" （ユーアールエルスキャナー、​カテゴリ）
phpMusselにはURLスキャナーがビルトインされていて、​スキャンされたファイルやデータ内の悪質なURLを検出することができます。

注意：URLスキャナーが無効の場合、​このカテゴリー（`urlscanner`）を参照する必要はありません。

URLスキャナーAPIルックアップ設定。

"lookup_hphosts" （ルックアップ・エイチピーホスツ）
- Trueにすると、​APIの[hpHosts](http://hosts-file.net/)ルックアップが有効になります。​hpHostsはAPIルックアップを実行するのに API鍵を必要としません。

"google_api_key" （グーグル・エーピーアイ・キー）
- 必要なAPI鍵が定義されれば、​APIのGoogle Safe Browsing APIルックアップが有効になります。​Google Safe Browsing APIルックアップスに必要なAPI鍵は、​[から取得することができます](https://console.developers.google.com/)。
- 注意：Google Safe Browsing APIルックアップはまだ完成していないので、​将来的な利用を想定しています。

"maximum_api_lookups" （マクシマム・エーピーアイ・ルックアップス）
- スキャン反復におけるAPIルックアップの最大回数。​APIルックアップの度にスキャン反復の時間が積み重なってしまうので、​スキャン処理の速度向上のため、​制限を設けたいと考えるかもしれません。​０は制限なしを意味します。​デフォルトは１０です。

"maximum_api_lookups_response" （マクシマム・エーピーアイ・ルックアップス・レスポンス）
- APIルックアップの回数制限を超えた時の対応です。​`false`（偽） = 何もしない/処理を継続する（Default/デフォルト）；​`true`（真） = ファイルにフラグを付ける/ブロックする。

"cache_time" （キャッシュ・タイム）
- APIルックアップの結果をどれくらいキャッシュするか（秒単位です）？​デフォルトは３６００秒（一時間）。

#### "legal" （リーガル、​カテゴリ）
法律要件に関するコンフィギュレーション。

*法律要件とこれがコンフィギュレーション要件に与える影響の詳細については、ドキュメントの「[法律情報](#SECTION11)」セクションを参照してください。*

"pseudonymise_ip_addresses" （プセユードニマイズ・アイピー・アドレセズ）
- ログ・ファイルを書き込むときにIPアドレス偽名化するか「プセユードニマイズ」？​True = はい；​False = いいえ（Default/デフォルルト）。

"privacy_policy" （プライバシー・ポリシー）
- 生成されたページのフッターに表示される関連プライバシー・ポリシーのアドレス。​ＵＲＬを指定するか、無効にしたい場合は空白のままにして下さい。

#### "template_data" （テンプレート・データ、​カテゴリ）
テンプレートとテーマ用のディレクティブ/変数。

テンプレートのデータは、​ユーザーに向けてアップロード拒否のメッセージをＨＴＭＬ形式でアウトプットする際に使用されます。​カスタムテーマを使っている場合は`template_custom.html`を使用して、​そうでない場合は`template.html`を使用してＨＴＭＬアウトプットが生成されます。​設定ファイル内にあるこのセクション用の変数は、​ＨＴＭＬアウトプットのために解析され、​で囲まれた変数名は対応する変数データに置き換えられます。​例えば`foo="bar"`とすると、​ＨＴＭＬアウトプット内の`<p>{foo}</p>`は`<p>bar</p>`となります。

"theme" （シーム/テーマ）
- phpMusselに使用するデフォルトテーマ。

"Magnification" （マグニフィケーション）
- フォントの倍率。​Default/デフォルルト = １。

"css_url" （シーエスエス・ユーアールエル）
- カスタムテーマ用のテンプレートファイルは、​外部ＣＳＳプロパティーを使っています。​一方、​デフォルトテーマは内部ＣＳＳです。​カスタムテーマを適用するためには、​ＣＳＳファイルのパブリック ＨＴＴＰアドレスを"css_url"変数を使って指定して下さい。​この変数が空白であれば、​デフォルトテーマが適用されます。

---


### ８.<a name="SECTION8"></a>シグネチャ（署名）フォーマット

*参照：*
- *[「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)*

phpMusselシグネチャ・ファイルの最初の9バイト（`[x0-x8]`）は`phpMussel`であり、​「マジック・ナンバー」（magic number）として機能します（それらをシグネチャ・ファイルとして識別するために）。​シグネチャ・ファイルではないファイルを誤って使用するのを防ぐのに役立ちます。​次のバイト（`[x9]`）は、シグネチャ・ファイルのタイプを識別する。​シグネチャ・ファイルを正しく解釈できるようにするためにこれを知っておく必要があります。​次のタイプのシグネチャ・ファイルが認識されます。

タイプ | バイト | 説明
---|---|---
`General_Command_Detections` | `0?` | ＣＳＶ（カンマ区切りの値）のシグネチャ・ファイル。​シグネチャは１６進数でエンコードされた文字列です。​ここの​シグネチャには、名前やその他の詳細はありません（検出する文字列のみ）。
`Filename` | `1?` | ファイル名の​シグネチャ。
`Hash` | `2?` | ハッシュ・シグネチャ。
`Standard` | `3?` | ファイルコンテンツで直接動作する​シグネチャ・ファイル。
`Standard_RegEx` | `4?` | ファイルコンテンツで直接動作する​シグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`Normalised` | `5?` | ＡＮＳＩ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。
`Normalised_RegEx` | `6?` | ＡＮＳＩ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`HTML` | `7?` | ＨＴＭＬ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。
`HTML_RegEx` | `8?` | ＨＴＭＬ標準化されたファイルコンテンツで動作するシグネチャ・ファイル。​シグネチャには正規表現を含めることができます。
`PE_Extended` | `9?` | ＰＥメタデータで動作するシグネチャ・ファイル（ＰＥのセクション・メタデータでは使用できません）。
`PE_Sectional` | `A?` | ＰＥセクション・メタデータで動作するシグネチャ・ファイル。
`Complex_Extended` | `B?` | phpMusselによって生成された拡張メタデータに基づいてさまざまなルールで動作するシグネチャ・ファイル。
`URL_Scanner` | `C?` | ＵＲＬで動作するシグネチャ・ファイル。

次のバイト（`[x10]`）は改行（`[0A]`）であり、phpMusselのシグネチャ・ファイルのヘッダを終えます。

その後の各空でない行は、​シグネチャまたは規則です。​各シグネチャまたは規則は１行を占有します。​サポートされているシグネチャ形式は以下のとおりです。

#### *ファイル名シグネチャ*
ファイル名シグネチャのフォーマットは例外なく次のようになります。

`NAME:FNRX`

NAMEはそのシグネチャを指す名前でFNRXはファイル名（エンコードされていない）にマッチする正規表現パターンです。

#### *ハッシュ・シグネチャ*
ハッシュ・シグネチャのフォーマットは例外なく次のようになります。

`HASH:FILESIZE:NAME`

HASHはファイル全体のハッシュ（通常はＭＤ５）、​FILESIZEはファイルの全サイズ、​NAMEはそのシグネチャを指す名前です。

#### *ＰＥセクショナルシグネチャ*
ＰＥセクショナルシグネチャのフォーマットは例外なく次のようになります。

`SIZE:HASH:NAME`

HASHはＰＥファイルのある部分のＭＤ５ハッシュ、​SIZEはその部分の全サイズ、​NAMEはシグネチャを指す名前です。

#### *ＰＥ拡張シグネチャ*
ＰＥ拡張シグネチャのフォーマットは例外なく次のようになります。

`$VAR:HASH:SIZE:NAME`

$VARはマッチするＰＥ変数の名前、​HASHはその変数のＭＤ５ハッシュ、​サイズは変数の全サイズ、​NAMEはそのシグネチャを指す名前です。

#### *複合拡張シグネチャ*
複合拡張シグネチャは他のシグネチャとは少し違い、​何に適合するかはそれ自身のシグネチャによって決まり、​基準は一つではありません。​適合基準は「;」により、​適合タイプ、​適合データは「:」によります。​したがってフォーマットは、​$変数１:何らかのデータ;$変数２:SOMEDATA;何らかのデータのようになります。

`$variable1:SOMEDATA;$variable2:SOMEDATA;SignatureName`

#### *その他*
その他のシグネチャのフォーマットです。

`NAME:HEX:FROM:TO`

NAMEはそのシグネチャを指す名前、​HEXは与えられたシグネチャにより適合を見るファイルの１６進法にエンコードされたセグメントです。​FROMとTOはオプション・パラメータで、​データソースのどこからどこまでチェックするかを示します（メール機能ではサポートしていません）。

#### *正規表現*
ＰＨＰが正規表現と判断し処理するフォーマットであれば、​phpMusselとシグネチャによって間違いなく処理されます。​しかし念のため、​シグネチャを基礎とする正規表現を新規に作成する場合は細心の注意を払って下さい。​絶対的な自信がない状況では、​思いもしないエラーが発生しかねません。​正規表現ステートメントが解析されているコンテキストを完全に理解していないならば、​phpMusselのコードを見て下さい。​パターンは全て（ファイル名、​アーカイブ・メタデータ、​ＭＤ５パターンを除く）１６進法でエンコードされなければならない点に注意(上記のパターン構文も)です！

---


### ９.<a name="SECTION9"></a>適合性問題

#### ＰＨＰとＰＣＲＥ
- phpMusselが正しく動作するためにはＰＨＰとＰＣＲＥが必要です。​どちらか一方でも欠けると正常に機能しません。​システムにＰＨＰとＰＣＲＥの両方がインストールされていることをphpMusselダウンロード前に確認して下さい。

#### アンチウィルスソフトウェアとの互換性

phpMusselは大概のウィルススキャンソフトウェアに対して互換性があります。​しかし、​過去にはユーザーから非互換性の報告があったのも確かです。​以下の情報はVirusTotal.comによるものであり、​phpMusselに対しアンチウィルスプログラムによって報告された誤検出を記載しています。​phpMusselと使用中のアンチウィルスソフトウェアの互換性問題が記載通りに必ず発生する、​あるいは発生しないことを保証するものではありませんが、​もしアンチウィルスソフトウェアとphpMusselの動作に顕著な矛盾が認められるようなら、​使用にあたってどちらか一方を無効にするなどの対策を検討すべきでしょう。

以下の情報は、​2017年12月1日にアップデートされ、​本稿執筆時におけるphpMussel最新マイナーバージョン（v1.0.0-v1.1.0）の現況です。

*この情報は、メインパッケージにのみ適用されます。​結果は、インストールされたシグネチャ・ファイル、プラグイン、およびその他の周辺コンポーネントに基づいて異なる場合があります。*

| スキャナ | 結果 |
|---|---|
| AVware | リポート "BPX.Shell.PHP" |
| Bkav | リポート "VEXA3F5.Webshell" |

---


### １０.<a name="SECTION10"></a>よくある質問（ＦＡＱ）

- [「シグネチャ」とは何ですか？](#WHAT_IS_A_SIGNATURE)
- [「偽陽性」とは何ですか？](#WHAT_IS_A_FALSE_POSITIVE)
- [シグネチャはどれくらいの頻度でアップデイトされますか？](#SIGNATURE_UPDATE_FREQUENCY)
- [phpMusselを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！](#ENCOUNTERED_PROBLEM_WHAT_TO_DO)
- [5.4.0より古いＰＨＰバージョンでphpMusselを使用したいと思います；​手伝ってくれますか？](#MINIMUM_PHP_VERSION)
- [複数のドメインを保護するために１つのphpMusselインストールを使用できますか？](#PROTECT_MULTIPLE_DOMAINS)
- [私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？](#PAY_YOU_TO_DO_IT)
- [あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？](#HIRE_FOR_PRIVATE_WORK)
- [私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？](#SPECIALIST_MODIFICATIONS)
- [私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？](#ACCEPT_OR_OFFER_WORK)
- [私はプロジェクトに貢献したい；​これはできますか？](#WANT_TO_CONTRIBUTE)
- [「ipaddr」の推奨値です。](#RECOMMENDED_VALUES_FOR_IPADDR)
- [ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？](#SCAN_DEBUGGING)
- [Cronを使って自動的にアップデートできますか？](#CRON_TO_UPDATE_AUTOMATICALLY)
- [phpMusselは、ＡＮＳＩ以外の名前のファイルをスキャンできますか？](#SCAN_NON_ANSI)
- [ブラックリスト – ホワイトリスト – グレーリスト – 彼らは何ですか？私はどのように使用しますか？](#BLACK_WHITE_GREY)

#### <a name="WHAT_IS_A_SIGNATURE"></a>「シグネチャ」とは何ですか？

phpMusselのコンテキストでは、​「シグネチャ」とは、​私たちが探しているものを特定するデータを指します（ウイルス、​トロイの木馬など）。​このデータは、​通常、​ファイルのチェックサム、​ハッシュ、​または他の同様に識別するインジケータです。​通常、​ラベルや追加のコンテキストを提供するためのその他のデータが含まれています。

#### <a name="WHAT_IS_A_FALSE_POSITIVE"></a>「偽陽性」とは何ですか？

一般化された文脈で簡単に説明、​条件の状態をテストするときに、​結果を参照する目的で、​用語「偽陽性」（*または：偽陽性のエラー、​虚報；* 英語：​*false positive*; *false positive error*; *false alarm*）の意味は、​結果は「陽性」のようです、​しかし結果は間違いです（即ち、​真の条件は「陽性/真」とみなされます、​しかしそれは本当に「陰性/偽」です）。​「偽陽性」は「泣く狼」に類似していると考えることができます（その状態は群の近くに狼がいるかどうかである、​真の条件は「偽/陰性」です、​群れの近くに狼がないからです、​しかし条件は「真/陽性」として報告されます、​羊飼いが「狼！​狼！​」を叫んだからです）、​または、​医療検査に類似、​患者が誤って診断されたとき。

いくつかの関連する用語は、​「真陽性」、​「真陰性」、​と「偽陰性」です。​これらの用語が示す意味：​「真陽性」の意味は、​テスト結果と真の条件が真です（即ち、​「陽性」です）。​「真陰性」の意味は、​テスト結果と真の条件が偽です（即ち、​「陰性」です）。​「真陽性」と「真陰性」は「正しい推論」とみなされます。​「偽陽性」の反対は「偽陰性」です。​「偽陰性」の意味は、​テスト結果が偽です（即ち、​「陰性」です）、​しかし、​真の条件が本当に真です（即ち、​「陽性」です）；​両方テスト結果と真の条件、​が「真/陽性」すべきであるはずです。

phpMusselの文脈で、​これらの用語は、​phpMusselのシグネチャとそれらがブロックするファイルを指します。​phpMusselが誤ってファイルをブロックすると（例えば、​不正確なシグネチャ、​時代遅れのシグネチャなどによる）、​我々はこのイベント「偽陽性」のを呼び出します。​phpMusselがファイルをブロックできなかった場合（例えば、​予期せぬ脅威、​シグネチャの欠落などによる）、​我々はこのイベント「不在検出」のを呼び出します（「偽陰性」のアナログです）。

これは、​以下の表に要約することができます。

&nbsp; | phpMusselは、​ファイルをブロック必要がありません | phpMusselは、​ファイルをブロック必要があります
---|---|---
phpMusselは、​ファイルをブロックしません | 真陰性（正しい推論） | 不在検出（それは「偽陰性」と同じです）
phpMusselは、​ファイルをブロックします | __偽陽性__ | 真陽性（正しい推論）

#### <a name="SIGNATURE_UPDATE_FREQUENCY"></a>シグネチャはどれくらいの頻度でアップデイトされますか？

アップデイト頻度は、​シグネチャファイルによって異なります。​phpMusselのシグネチャファイルのすべてのメンテナーが頻繁にアップデイトを試みる、​しかし、​私たちの皆様には、​他にもさまざまなコミットメントがあり、​私たちはプロジェクトの外で生活しており、​と誰も財政的に補償されていない、​したがって、​正確なアップデイトスケジュールは保証されません。​一般に、​十分な時間があればシグネチャがアップデイトされます。​メンテナーは必要性と範囲間の変化の頻度に基づいて優先順位をつけようとする。​あなたが何かを提供できるのであれば、​援助は常に高く評価されます。

#### <a name="ENCOUNTERED_PROBLEM_WHAT_TO_DO"></a>phpMusselを使用しているときに問題が発生しましたが、​何をすべきかわかりません！​助けてください！

- あなたは最新のソフトウェアバージョンを使用していますか？​あなたは最新のシグネチャファイルバージョンを使用していますか？​そうでない場合は、​まずすべてをアップデイトしてください。​問題が解決しないかどうかをチェックしてください。​それが続く場合は、​読んでください。
- あなたはドキュメンテーションをチェックしましたか？​もしそうでなければ、​そうしてください。​ドキュメンテーションを使用して問題を解決できない場合は、​引き続き読んでください。
- **[イシュー・ページ](https://github.com/phpMussel/phpMussel/issues)** をチェックしましたか？​問題が以前に言及されているかどうかをチェックしてください。​提案、​アイデア、​ソリューションが提供されたかどうかをチェックしてください。
- 問題が解決しない場合は、​教えてください。​イシュー・ページに関する新しいディスカッションを作成する。

#### <a name="MINIMUM_PHP_VERSION"></a>5.4.0より古いＰＨＰバージョンでphpMusselを使用したいと思います；​手伝ってくれますか？

いいえ。​PHP 5.4.0は2014年に公式EoL（「End of Life」/人生の終わり）に達しました。​長期的なセキュリティサポートは2015年に終了しました。​現在、​それは2017であり、​PHP 7.1.0はすでに利用可能です。​現在、​PHP 5.4.0およびすべてのより新しいＰＨＰバージョンでphpMusselを使用するためのサポートが提供されています。​より古いＰＨＰバージョンのサポートは提供されていません。

*参照：​[互換性チャート](https://maikuolan.github.io/Compatibility-Charts/)。*

#### <a name="PROTECT_MULTIPLE_DOMAINS"></a>複数のドメインを保護するために１つのphpMusselインストールを使用できますか？

はい。​phpMusselのインストールは特定のドメインに限定されていません、​したがって、​複数のドメインを保護するために使用できます。​一般的に、​１つのドメインのみを保護するインストール、​私たちは「単一ドメイン・インストール」と呼んでいますで、​複数のドメイン/サブドメインを保護するインストール、​私たちは「マルチドメイン・インストール」と呼んでいます。​マルチドメインインストールを使用している場合で、​異なるドメインに異なるシグネチャ・ファイルセットを使用する必要がある場合や、​異なるドメインにphpMusselを異なる設定する必要があります、​これを行うことができます。​コンフィグレーション・ファイルをロードした後（`config.ini`）、​phpMusselは、​要求されたドメインの「コンフィグレーション・オーバーライド・ファイル」の存在をチェックします (`xn--48jua8kwd4hof5er493ch97b.tld.config.ini`)、​そして見つかった場合、​コンフィグレーション・オーバーライド・ファイルによって定義されたコンフィグレーション値は、​コンフィグレーション・ファイルによって定義されたコンフィグレーション値ではなく、​実行インスタンスに使用されます。​コンフィグレーション・オーバーライド・ファイルは、​コンフィグレーション・ファイルと同じです。​お客様の裁量で、​phpMusselで利用可能なすべての設定指示句の全体または必要なサブセクションを含めることができます。​コンフィグレーション・オーバーライド・ファイルは彼らが意図しているドメインに従って命名されます （そう、​例えば、​ドメイン`http://www.some-domain.tld/`にコンフィグレーション・オーバーライド・ファイルが必要な場合は、​コンフィグレーション・オーバーライド・ファイルの名前は`some-domain.tld.config.ini`にする必要があります。​通常の設定ファイルと同じ場所に保存する必要があります）。​ドメイン名は `HTTP_HOST` から来ます。​"www"は無視されます。

#### <a name="PAY_YOU_TO_DO_IT"></a>私はこれをインストールするか、​それが私のウェブサイト上で動作することを保証する時間を費やす、​にしたくない；​それできますか？​私はあなたを雇うことができますか？

多分。​これは、​ケースバイケースで検討されています。​あなたのニーズと提供できるものを教えてください。​私たちが助けることができるかどうかを教えてあげます。

#### <a name="HIRE_FOR_PRIVATE_WORK"></a>あなたまたはこのプロジェクトの任意の開発者は雇用可能ですか？

*上記を参照。​*

#### <a name="SPECIALIST_MODIFICATIONS"></a>私は専門家の変更、​カスタム化、​等が必要です；​手伝ってくれますか？

*上記を参照。​*

#### <a name="ACCEPT_OR_OFFER_WORK"></a>私は開発者、​ウェブサイトデザイナー、​またはプログラマーです。​このプロジェクトに関連する作業を行うことはできますか？

はい。​私たちのライセンスはこれを禁止していません。

#### <a name="WANT_TO_CONTRIBUTE"></a>私はプロジェクトに貢献したい；​これはできますか？

はい。​プロジェクトへの貢献は大歓迎です。​詳細については、​「CONTRIBUTING.md」を参照してください。

#### <a name="RECOMMENDED_VALUES_FOR_IPADDR"></a>「ipaddr」の推奨値です。

値 | 使用
---|---
`HTTP_INCAP_CLIENT_IP` | Incapsulaリバース・プロキシ。
`HTTP_CF_CONNECTING_IP` | Cloudflareリバース・プロキシ。
`CF-Connecting-IP` | Cloudflareリバース・プロキシ（代替；上記がうまくいかない場合）。
`HTTP_X_FORWARDED_FOR` | Cloudbricリバース・プロキシ。
`X-Forwarded-For` | [Squidリバース・プロキシ](http://www.squid-cache.org/Doc/config/forwarded_for/)。
*サーバー・コンフィグレーションによって定義されます。​* | [Nginxリバース・プロキシ](https://www.nginx.com/resources/admin-guide/reverse-proxy/)。
`REMOTE_ADDR` | リバース・プロキシはありません（デフォルト値）。

#### <a name="SCAN_DEBUGGING"></a>ファイルのスキャン時に特定の詳細情報にアクセスするにはどうすればよいですか？

これは、​phpMusselにそれらをスキャンするように指示する前に、​この目的のために使用する配列を割り当てることによって行うことができます。

以下の例では、​この目的のために`$Foo`が割り当てられています。​`/file/path/...`をスキャンした後、​`/file/path/...`のファイルに関する情報は`$Foo`にあります。

```PHP
<?php
require 'phpmussel/loader.php';

$phpMussel['Set-Scan-Debug-Array']($Foo);

$Results = $phpMussel['Scan']('/file/path/...');

var_dump($Foo);
```

配列は多次元です。​要素はスキャンされる各ファイルを表します。​サブ要素は、​これらのファイルの詳細を表します。​サブ要素は次のとおりです。

- Filename (`string`)
- FromCache (`bool`)
- Depth (`int`)
- Size (`int`)
- MD5 (`string`)
- SHA1 (`string`)
- CRC32B (`string`)
- 2CC (`string`)
- 4CC (`string`)
- ScanPhase (`string`)
- Container (`string`)
- † FileSwitch (`string`)
- † Is_ELF (`bool`)
- † Is_Graphics (`bool`)
- † Is_HTML (`bool`)
- † Is_Email (`bool`)
- † Is_MachO (`bool`)
- † Is_PDF (`bool`)
- † Is_SWF (`bool`)
- † Is_PE (`bool`)
- † Is_Not_HTML (`bool`)
- † Is_Not_PHP (`bool`)
- ‡ NumOfSections (`int`)
- ‡ PEFileDescription (`string`)
- ‡ PEFileVersion (`string`)
- ‡ PEProductName (`string`)
- ‡ PEProductVersion (`string`)
- ‡ PECopyright (`string`)
- ‡ PEOriginalFilename (`string`)
- ‡ PECompanyName (`string`)
- Results (`int`)
- Output (`string`)

*† - キャッシュされた結果は提供されません （新しいスキャン結果にのみ提供されます）。​*

*‡ - ＰＥファイルをスキャンするときにのみ提供されます。​*

必要に応じて、​この配列は以下を使用して破棄できます。

```PHP
$phpMussel['Destroy-Scan-Debug-Array']($Foo);
```

#### <a name="CRON_TO_UPDATE_AUTOMATICALLY"></a>Cronを使って自動的にアップデートできますか？

はい。​外部スクリプトを介してアップデート・ページと対話するためのＡＰＩがフロントエンドに組み込まれています。​別のスクリプト、「[Cronable](https://github.com/Maikuolan/Cronable)」、が利用可能です。​これは「cron manager （クロン・マネージャー）」や「cron scheduler （クロン・スケジューラ）」がこれと他のサポートされているパッケージを自動的に更新するために使うことができます（このスクリプトは独自のドキュメントを提供しています）。

#### <a name="SCAN_NON_ANSI"></a>phpMusselは、ＡＮＳＩ以外の名前のファイルをスキャンできますか？

スキャンするディレクトリがあるとします。​このディレクトリには、ＡＮＳＩ以外の名前のファイルがいくつかあります。
- `Пример.txt`
- `一个例子.txt`
- `例です.txt`

ＣＬＩモードまたはphpMussel APIを使用してスキャンしているとします。

一部のシステムで PHP < 7.1.0 を使用する場合、phpMusselはディレクトリをスキャンするときにこれらのファイルを表示またはスキャンすることができません。​空のディレクトリをスキャンすると、同じ結果が表示されます。

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

さらに、 PHP < 7.1.0 を使用する場合、ファイルを個別にスキャンすると次のような結果が得られます。

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > チェック中 'X:/directory/Пример.txt' (FN: b831eb8f):
 -> 不正ファイル！
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

または、これら：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > X:/directory/??????.txtはファイルでもディレクトリでもありません。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

これは、ＡＮＳＩ以外のファイル名が PHP 7.1.0 より前にどのように処理されるかが原因です。​この問題が発生した場合、解決策はPHPのインストールを更新することです。​PHP >= 7.1.0 の場合、非ＡＮＳＩファイル名はよりよく処理され、phpMusselはファイルを適切にスキャンできるはずです。

比較のため、PHP >= 7.1.0 を使用してディレクトリをスキャンしようとしたときの結果：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 -> チェック中 '\Пример.txt' (FN: b2ce2d31; FD: 27cbe813):
 --> 問題は検出されませんでした。
 -> チェック中 '\一个例子.txt' (FN: 50debed5; FD: 27cbe813):
 --> 問題は検出されませんでした。
 -> チェック中 '\例です.txt' (FN: ee20a2ae; FD: 27cbe813):
 --> 問題は検出されませんでした。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

ファイルを個別にスキャンしようとすると、次のようになります：

```
 Sun, 01 Apr 2018 22:27:41 +0800 開始。
 > チェック中 'X:/directory/Пример.txt' (FN: b831eb8f; FD: 27cbe813):
 -> 問題は検出されませんでした。
 Sun, 01 Apr 2018 22:27:41 +0800 完了。
```

#### <a name="BLACK_WHITE_GREY"></a>ブラックリスト – ホワイトリスト – グレーリスト – 彼らは何ですか？私はどのように使用しますか？

これらの用語は、異なる文脈で異なる意味を伝える。​phpMusselには、これらの用語が使用される３つのコンテキストが（ファイルサイズの応答、ファイルタイプの応答、シグネチャ・グレーリスト）あります。

処理コストを最小限に抑えて希望の結果を得るために、phpMusselがファイルを実際にスキャンする前に確認できる簡単な方法がいくつかあります（例えば；ファイルのサイズ、名前、および拡張子）。​​例えば；ファイルが大きすぎる場合、またはその拡張子が私たちのウェブサイトに許可したくないファイルの種類を示している場合、すぐにファイルにフラグを立てることができますし、スキャンする必要はありません。

ファイルサイズの応答は、ファイルが指定された制限を超えたときにphpMusselが応答する方法です。​実際のリストは含まれていませんが、ファイルはそのサイズに基づいて、効果的にブラックリストに載っている、ホワイトリストに載っている、またはグレイリストに載ってと考えられます。​制限と望ましい応答をそれぞれ指定するために、２つの異なる設定オプションが存在します。

ファイルタイプの応答は、phpMusselがファイルの拡張子に応答する方法です。​どの拡張がブラックリスト、ホワイトリスト、またはグリットリストにあるべきかを明示的に指定するための3つの異なる設定オプションが存在します。​拡張子が指定された拡張子のいずれかにそれぞれ一致する場合、ファイルは有効にリストされていると見なされることがあります。

この２つのコンテキストがでは、ホワイトリストに載っているはスキャンまたはフラグ付けすべきではないことを意味します、ブラックリストに載っているはフラグ付けすべきですことを意味します（したがって、それをスキャンするすべきではない）そして、グレーリストに載っているは、フラグを立てる必要があるかどうかを判断するには、さらに分析が必要ですことを意味します（したがって、スキャンする必要があります）。

シグネチャ・グレーリストは本質的に無視すべきシグネチャのリストです（これについては、前述のドキュメントで簡単に説明しています）。​シグネチャはグレーリスト上のシグネチャがトリガーされると、phpMusselは私は仕事を続け、グレーリスト上のシグネチャに関して特別な処置をとりません。​暗黙の動作はトリガされたシグネチャの通常の動作であるため、シグネチャ・ブラックリストはありません。​この文脈では必要ではないので、シグネチャ・ホワイトリストはありません。

シグネチャ・ファイル全体をディセーブルまたはアンインストールせずに特定のシグネチャによって発生した問題を解決する必要がある場合は、シグネチャ・グレーリストが役立ちます。

---


### １１.<a name="SECTION11"></a>法律情報

#### 11.0 SECTION PREAMBLE

This section of the documentation is intended to describe possible legal considerations regarding the use and implementation of the package, and to provide some basic related information. This may be important for some users as a means to ensure compliancy with any legal requirements that may exist in the countries that they operate in, and some users may need to adjust their website policies in accordance with this information.

First and foremost, please realise that I (the package author) am not a lawyer, nor a qualified legal professional of any kind. Therefore, I am not legally qualified to provide legal advice. Also, in some cases, exact legal requirements may vary between different countries and jurisdictions, and these varying legal requirements may sometimes conflict (such as, for example, in the case of countries that favour privacy rights and the right to be forgotten, versus countries that favour extended data retention). Consider also that access to the package is not restricted to specific countries or jurisdictions, and therefore, the package userbase is likely to the geographically diverse. These points considered, I'm not in a position to state what it means to be "legally compliant" for all users, in all regards. However, I hope that the information herein will help you to come to a decision yourself regarding what you must do in order to remain legally compliant in the context of the package. If you have any doubts or concerns regarding the information herein, or if you need additional help and advice from a legal perspective, I would recommend consulting a qualified legal professional.

#### 11.1 LIABILITY AND RESPONSIBILITY

As per already stated by the package license, the package is provided without any warranty. This includes (but is not limited to) all scope of liability. The package is provided to you for your convenience, in the hope that it will be useful, and that it will provide some benefit for you. However, whether you use or implement the package, is your own choice. You are not forced to use or implement the package, but when you do so, you are responsible for that decision. Neither I, nor any other contributors to the package, are legally responsible for the consequences of the decisions that you make, regardless of whether direct, indirect, implied, or otherwise.

#### 11.2 THIRD PARTIES

Depending on its exact configuration and implementation, the package may communicate and share information with third parties in some cases. This information may be defined as "personally identifiable information" (PII) in some contexts, by some jurisdictions.

How this information may be used by these third parties, is subject to the various policies set forth by these third parties, and is outside the scope of this documentation. However, in all such cases, sharing of information with these third parties can be disabled. In all such cases, if you choose to enable it, it is your responsibility to research any concerns that you may have regarding the privacy, security, and usage of PII by these third parties. If any doubts exist, or if you're unsatisfied with the conduct of these third parties in regards to PII, it may be best to disable all sharing of information with these third parties.

For the purpose of transparency, the type of information shared, and with whom, is described below.

##### 11.2.0 WEBFONTS

Some custom themes, as well as the the standard UI ("user interface") for the phpMussel front-end and the "Upload Denied" page, may use webfonts for aesthetic reasons. Webfonts are disabled by default, but when enabled, direct communication between the user's browser and the service hosting the webfonts occurs. This may potentially involve communicating information such as the user's IP address, user agent, operating system, and other details available to the request. Most of these webfonts are hosted by the Google Fonts service.

*Relevant configuration directives:*
- `general` -> `disable_webfonts`

##### 11.2.1 URL SCANNER

URLs found within file uploads may be shared with the hpHosts API or the Google Safe Browsing API, depending on how the package is configured. In the case of the hpHosts API, this behaviour is enabled by default. The Google Safe Browsing API requires API keys in order to work correctly, and is therefore disabled by default.

*Relevant configuration directives:*
- `urlscanner` -> `lookup_hphosts`
- `urlscanner` -> `google_api_key`

##### 11.2.2 VIRUS TOTAL

When phpMussel scans a file upload, the hashes of those files may be shared with the Virus Total API, depending on how the package is configured. There are plans to be able to share entire files at some point in the future too, but this feature isn't supported by the package at this time. The Virus Total API requires an API key in order to work correctly, and is therefore disabled by default.

Information (including files and related file metadata) shared with Virus Total, may also be shared with their partners, affiliates, and various others for research purposes. This is described in more detail by their privacy policy.

*See: [Privacy Policy &ndash; VirusTotal](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy).*

*Relevant configuration directives:*
- `virustotal` -> `vt_public_api_key`

#### 11.3 LOGGING

Logging is an important part of phpMussel for a number of reasons. Without logging, it may be difficult to diagnose false positives, to ascertain exactly how performant phpMussel is in any particular context, and to determine where its shortfalls may be, and what changes may be required to its configuration or signatures accordingly, in order for it to continue functioning as intended. Regardless, logging mightn't be desirable for all users, and remains entirely optional. In phpMussel, logging is disabled by default. To enable it, phpMussel must be configured accordingly.

Additionally, whether logging is legally permissible, and to the extent that it is legally permissible (e.g., the types of information that may logged, for how long, and under what circumstances), may vary, depending on jurisdiction and on the context where phpMussel is implemented (e.g., whether you're operating as an individual, as a corporate entity, and whether on a commercial or non-commercial basis). It may therefore be useful for you to read through this section carefully.

There are multiple types of logging that phpMussel can perform. Different types of logging involves different types of information, for different reasons.

##### 11.3.0 SCAN LOGS

When enabled in the package configuration, phpMussel keeps logs of the files it scans. This type of logging is available in two different formats:
- Human readable logfiles.
- Serialised logfiles.

Entries to a human readable logfile typically look something like this (as an example):

```
Mon, 21 May 2018 00:47:58 +0800 Started.
> Checking 'ascii_standard_testfile.txt' (FN: ce76ae7a; FD: 7b9bfed5):
-> Detected phpMussel-Testfile.ASCII.Standard!
Mon, 21 May 2018 00:48:04 +0800 Finished.
```

A scan log entry typically includes the following information:
- The date and time that the file was scanned.
- The name of the file scanned.
- CRC32b hashes of the name and contents of the file.
- What was detected in the file (if anything was detected).

*Relevant configuration directives:*
- `general` -> `scan_log`
- `general` -> `scan_log_serialized`

When these directives are left empty, this type of logging will remain disabled.

##### 11.3.1 SCAN KILLS

When enabled in the package configuration, phpMussel keeps logs of the uploads that have been blocked.

Entries to a "scan kills" logfile typically look something like this (as an example):

```
DATE: Mon, 21 May 2018 00:47:56 +0800
IP ADDRESS: 127.0.0.1
== SCAN RESULTS / WHY FLAGGED ==
Detected phpMussel-Testfile.ASCII.Standard (ascii_standard_testfile.txt)!
== MD5 SIGNATURE RECONSTRUCTION (FILE-HASH:FILE-SIZE:FILE-NAME) ==
3ed8a00c6c498a96a44d56533806153c:666:ascii_standard_testfile.txt
Quarantined as "/vault/quarantine/0000000000-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.qfu".
```

A "scan kills" entry typically includes the following information:
- The date and time that the upload was blocked.
- The IP address where the upload originated from.
- The reason why the file was blocked (what was detected).
- The name of the file blocked.
- An MD5 and the size of the file blocked.
- Whether the file was quarantined, and under what internal name.

*Relevant configuration directives:*
- `general` -> `scan_kills`

##### 11.3.2 FRONT-END LOGGING

This type of logging relates front-end login attempts, and occurs only when a user attempts to log into the front-end (assuming front-end access is enabled).

A front-end log entry contains the IP address of the user attempting to log in, the date and time that the attempt occurred, and the results of the attempt (successfully logged in, or failed to log in). A front-end log entry typically looks something like this (as an example):

```
x.x.x.x - Day, dd Mon 20xx hh:ii:ss +0000 - "admin" - Logged in.
```

*Relevant configuration directives:*
- `general` -> `FrontEndLog`

##### 11.3.3 LOG ROTATION

You may want to purge logs after a period of time, or may be required to do so by law (i.e., the amount of time that it's legally permissible for you to retain logs may be limited by law). You can achieve this by including date/time markers in the names of your logfiles as per specified by your package configuration (e.g., `{yyyy}-{mm}-{dd}.log`), and then enabling log rotation (log rotation allows you to perform some action on logfiles when specified limits are exceeded).

For example: If I was legally required to delete logs after 30 days, I could specify `{dd}.log` in the names of my logfiles (`{dd}` represents days), set the value of `log_rotation_limit` to 30, and set the value of `log_rotation_action` to `Delete`.

Conversely, if you're required to retain logs for an extended period of time, you could either not use log rotation at all, or you could set the value of `log_rotation_action` to `Archive`, to compress logfiles, thereby reducing the total amount of disk space that they occupy.

*Relevant configuration directives:*
- `general` -> `log_rotation_limit`
- `general` -> `log_rotation_action`

##### 11.3.4 LOG TRUNCATION

It's also possible to truncate individual logfiles when they exceed a certain size, if this is something you might need or want to do.

*Relevant configuration directives:*
- `general` -> `truncate`

##### 11.3.5 IP ADDRESS PSEUDONYMISATION

Firstly, if you're not familiar with the term "pseudonymisation", the following resources can help explain it in some detail:
- [[trust-hub.com] What is pseudonymisation?](https://www.trust-hub.com/news/what-is-pseudonymisation/)
- [[Wikipedia] Pseudonymization](https://en.wikipedia.org/wiki/Pseudonymization)

In some circumstances, you may be legally required to anonymise or pseudonymise any PII collected, processed, or stored. Although this concept has existed for quite some time now, GDPR/DSGVO notably mentions, and specifically encourages "pseudonymisation".

phpMussel is able to pseudonymise IP addresses when logging them, if this is something you might need or want to do. When phpMussel pseudonymises IP addresses, when logged, the final octet of IPv4 addresses, and everything after the second part of IPv6 addresses is represented by an "x" (effectively rounding IPv4 addresses to the initial address of the 24th subnet they factor into, and IPv6 addresses to the initial address of the 32nd subnet they factor into).

*Relevant configuration directives:*
- `legal` -> `pseudonymise_ip_addresses`

##### 11.3.6 STATISTICS

phpMussel is optionally able to track statistics such as the total number of file scanned and blocked since some particular point in time. This feature is disabled by default, but can be enabled via the package configuration. The type of information tracked shouldn't be regarded as PII.

*Relevant configuration directives:*
- `general` -> `statistics`

##### 11.3.7 ENCRYPTION

phpMussel doesn't encrypt its cache or any log information. Cache and log encryption may be introduced in the future, but there aren't any specific plans for it currently. If you're concerned about unauthorised third parties gaining access to parts of phpMussel that may contain PII or sensitive information such as its cache or logs, I would recommend that phpMussel not be installed at a publicly accessible location (e.g., install phpMussel outside the standard `public_html` directory or equivalent thereof available to most standard webservers) and that appropriately restrictive permissions be enforced for the directory where it resides (in particular, for the vault directory). If that isn't sufficient to address your concerns, then configure phpMussel as such that the types of information causing your concerns won't be collected or logged in the first place (such as, by disabling logging).

#### 11.4 COOKIES

When a user successfully logs into the front-end, phpMussel sets a cookie in order to be able to remember the user for subsequent requests (i.e., cookies are used for authenticate the user to a login session). On the login page, a cookie warning is displayed prominently, warning the user that a cookie will be set if they engage in the relevant action. Cookies aren't set at any other points in the codebase.

*Relevant configuration directives:*
- `general` -> `disable_frontend`

#### 11.5 MARKETING AND ADVERTISING

phpMussel doesn't collect or process any information for marketing or advertising purposes, and neither sells nor profits from any collected or logged information. phpMussel is not a commercial enterprise, nor is related to any commercial interests, so doing these things wouldn't make any sense. This has been the case since the beginning of the project, and continues to be the case today. Additionally, doing these things would be counter-productive to the spirit and intended purpose of the project as a whole, and for as long as I continue to maintain the project, will never happen.

#### 11.6 PRIVACY POLICY

In some circumstances, you may be legally required to clearly display a link to your privacy policy on all pages and sections of your website. This may be important as a means to ensure that users and well-informed of your exact privacy practices, the types of PII you collect, and how you intend to use it. In order to be able to include such a link on phpMussel's "Upload Denied" page, a configuration directive is provided to specify the URL to your privacy policy.

*Relevant configuration directives:*
- `legal` -> `privacy_policy`

#### 11.7 GDPR/DSGVO

The General Data Protection Regulation (GDPR) is a regulation of the European Union, which comes into effect as of May 25, 2018. The primary goal of the regulation is to give control to EU citizens and residents regarding their own personal data, and to unify regulation within the EU concerning privacy and personal data.

The regulation contains specific provisions pertaining to the processing of "personally identifiable information" (PII) of any "data subjects" (any identified or identifiable natural person) either from or within the EU. To be compliant with the regulation, "enterprises" (as per defined by the regulation), and any relevant systems and processes must implement "privacy by design" by default, must use the highest possible privacy settings, must implement necessary safeguards for any stored or processed information (including, but not limited to, the implementation of pseudonymisation or full anonymisation of data), must clearly and unambiguously declare the types of data they collect, how they process it, for what reasons, for how long they retain it, and whether they share this data with any third parties, the types of data shared with third parties, how, why, and so on.

Data may not be processed unless there's a lawful basis for doing so, as per defined by the regulation. Generally, this means that in order to process a data subject's data on a lawful basis, it must be done in compliance with legal obligations, or done only after explicit, well-informed, unambiguous consent has been obtained from the data subject.

Because aspects of the regulation may evolve in time, in order to avoid the propagation of outdated information, it may be better to learn about the regulation from an authoritative source, as opposed to simply including the relevant information here in the package documentation (which may eventually become outdated as the regulation evolves).

[EUR-Lex](https://eur-lex.europa.eu/) (a part of the official website of the European Union that provides information about EU law) provides extensive information about GDPR/DSGVO, available in 24 different languages (at the time of writing this), and available for download in PDF format. I would definitely recommend reading the information that they provide, in order to learn more about GDPR/DSGVO:
- [REGULATION (EU) 2016/679 OF THE EUROPEAN PARLIAMENT AND OF THE COUNCIL](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=celex:32016R0679)

Alternatively, there's a brief (non-authoritative) overview of GDPR/DSGVO available at Wikipedia:
- [General Data Protection Regulation](https://en.wikipedia.org/wiki/General_Data_Protection_Regulation)

---


最終アップデート：2018年5月25日。
